<head> 
  <link rel="stylesheet" href="styles.css">
  <script src="AMHome.js"></script>
  <script src="LocalZip.js"></script>
  <script src="RLClass.js"></script>
  <script src="Progistics.js"></script>
  <script src="fullState.js"></script>
  <script src="AMMasterZips.js"></script>
  <script src="ProgisticsMap.js"></script>
  <script src="ProGrid.js"></script>
  <script src="RLMasterMap.js"></script>
  <script src="partcheck.js"></script>
  <script src="XPO.js"></script>
  <script src="AMQuote.js"></script>

</head>
<style>
</style>
<body>
  <form id="myForm">
    <div id="filePicker" >
      <label>
        <input type="file" id="csvFile" accept=".csv" />
        <span id="file-name-upload" class="btn btn-primary">Click here to open file</span>
      </label>
    </div>
    <div id="sumbitButton">
      <label>
        <input type="submit" id="submit" value="Submit" />
        <span class="btn btn-primary">Submit & Download</span>
      </label>
    </div>
  </form>
  <div class="tab">
    <button class="tablinks" onclick="openCity(event, 'AMHOME')" id="AMTab">AMHOME</button>
    <button class="tablinks" onclick="openCity(event, 'PROGISTICS')" id="ProTab">PROGISTICS</button>
    <button class="tablinks" onclick="openCity(event, 'FEDEX')" id="FXTab">FEDEX</button>
    <button class="tablinks" onclick="openCity(event, 'RL')" id="RLTab">R&L</button>
    <button class="tablinks" onclick="openCity(event, 'DROPSHIP')" id="DSTab">DROP SHIP</button>
    <button class="tablinks" onclick="openCity(event, 'HaulInstall')" id="HITab">Haul/Install</button>
    <button class="tablinks" onclick="openCity(event, 'ShipStandard')"id="SSTab">Ship Standard</button>
    <button class="tablinks" onclick="openCity(event, 'ShipInside')"id="SITab">Ship Inside</button>
    <button class="tablinks" onclick="openCity(event, 'ShipFree')" id="XPOTab">XPO</button>
    <button class="tablinks" onclick="openCity(event, 'OtherTab')" id="EmptyTab">Empty/Done</button>
    <button class="tablinks" onclick="openCity(event, 'RL/Progistics')" id="UncatTab">Rl/Pro</button>
    <button class="tablinks" onclick="openCity(event, 'LocalTab')"id="LocTab">Local</button>
  </div>
  <div id="AMHOME" class="tabcontent">
    <table id="AMTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="PROGISTICS" class="tabcontent">
    <table id="ProTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="RL" class="tabcontent">
    <table id="RLTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="FEDEX" class="tabcontent">
    <table id="FXTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="DROPSHIP" class="tabcontent">
    <table id="DSTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="HaulInstall" class="tabcontent">
    <table id="HITable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="ShipStandard" class="tabcontent">
    <table id="SSTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="ShipInside" class="tabcontent">
    <table id="SITable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="ShipFree" class="tabcontent">
    <table id="XPOTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="OtherTab" class="tabcontent">
    <table id="EmptyTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="RL/Progistics" class="tabcontent">
    <table id="RL/ProTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <div id="LocalTab" class="tabcontent">
    <table id="LocalTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Zip</th>
        <th>Phone</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>String</th>
        <th>Link</th>
        <th>Carrier</th>
      </tr>
    </table>
  </div>
  <script>
    let AMQuoteArr =[]
    const reducer = (accumulator, currentValue) => accumulator + currentValue;
    const myForm = document.getElementById("myForm");
    const csvFile = document.getElementById("csvFile");
    let FxCount = 1
    let RlCount = 1
    let AMCount = 1
    let ProCount = 1
    let HiCount = 1
    let EmptyCount = 1
    let XPOCount = 1


    let globalObjArr = []
    let fxArr =[]
    let proArr =[]
    let rlArr = []
    let amArr = []
    let dsArr = []
    let hiArr =[]
    let siArr =[]
    let ssArr =[]
    let sfArr =[]
    let infoArea = document.getElementById('file-name-upload');
    csvFile.addEventListener( 'change', showFileName );
    function showFileName( event ) {
      let input = event.srcElement;
      let fileName = input.files[0].name;
      infoArea.textContent = fileName;
    }
    function getTableQuantity(tableid){
      let rowCount = document.getElementById(tableid).rows.length;
      return rowCount
    }
    function checkPO (arr){
      let otherArr = []
      let DsCount = 0
      for (let i = 0; i < arr.length; i++) {
        if (arr[i].ProductWeight === 0 && arr[i].ProductCube === 0) {
          skuSplit(arr[i],"EmptyTable",EmptyCount)
          EmptyCount++
        }
        else if (arr[i].DS === true ) {dsArr.push(arr[i])}
          else{otherArr.push(arr[i])}
      }
      for (let i = 0; i < dsArr.length; i++){
        if(dsArr[i].ProductWeight > 0 && dsArr[i].ProductWeight < 10){
          skuSplit(dsArr[i],"FXTable",FxCount)
          FxCount++
        }
        else{
          skuSplit(dsArr[i],"DSTable",DsCount)
          DsCount++
        }
      }
      return otherArr
    }
    function TableAmounts(){
      let fxRows = document.getElementById("FXTable").rows.length - 1;
      let AmRows = document.getElementById("AMTable").rows.length - 1;
      let RLRows = document.getElementById("RLTable").rows.length - 1;
      let ProRows = document.getElementById("ProTable").rows.length - 1;
      let SSRows = document.getElementById("SSTable").rows.length - 1;
      let DSRows = document.getElementById("DSTable").rows.length - 1;
      let HIRows = document.getElementById("HITable").rows.length - 1;
      let LocalRows = document.getElementById("LocalTable").rows.length - 1;
      let SIRows = document.getElementById("SITable").rows.length - 1;
      let EmptyRows = document.getElementById("EmptyTable").rows.length - 1;
      let OtherRows = document.getElementById("RL/ProTable").rows.length - 1;
      let XPORows = document.getElementById("XPOTable").rows.length - 1;
      document.getElementById("AMTab").innerText = `AMHOME(${AmRows})` 
      document.getElementById("FXTab").innerText = `FEDEX(${fxRows})`
      document.getElementById("RLTab").innerText = `R&L(${RLRows})`
      document.getElementById("SSTab").innerText = `Ship Standard(${SSRows})`
      document.getElementById("DSTab").innerText = `Drop Ship(${DSRows})`
      document.getElementById("HITab").innerText = `Haul/Install(${HIRows})`
      document.getElementById("LocTab").innerText = `Local(${LocalRows})`
      document.getElementById("ProTab").innerText = `Progistics(${ProRows})`
      document.getElementById("SITab").innerText = `Ship Inside(${SIRows})`   
      document.getElementById("EmptyTab").innerText = `Empty/Done(${EmptyRows})` 
      document.getElementById("UncatTab").innerText = `Uncategorized(${OtherRows})`
      document.getElementById("XPOTab").innerText = `XPO(${XPORows})`          
      
    }
    function checkLocal(arr){
      let otherArr = []
      let LocalCount = 0
      for (let i = 0; i < arr.length; i++) {
        if (XPOMapper(arr[i].Zip) != "N/A") {
          skuSplit(arr[i],"XPOTable",XPOCount)
          XPOCount++
        }
        else if (arr[i].Local === true) {
          skuSplit(arr[i],"LocalTable",LocalCount)
          LocalCount++
        }
        else{otherArr.push(arr[i])}
      }
      return otherArr
    }
    function pad(num, size) {
      num = num.toString();
      while (num.length < size) num = "0" + num;
      return num;
    }
    function checkAgent(arr){
      let otherArr = []
      for (let i = 0; i < arr.length; i++) {
        if(arr[i].ShipAgent === "AM_Home"){
          amArr.push(arr[i])
          skuSplit(arr[i],"AMTable",AMCount)
          AMCount++
        }
        else if(arr[i].ShipAgent === "Progistics"){
          proArr.push(arr[i])
          skuSplit(arr[i],"ProTable",ProCount)
          ProCount++
        }
        else if(arr[i].ShipAgent === "R&L"){
          rlArr.push(arr[i])
          skuSplit(arr[i],"RLTable",RlCount)
          RlCount++
        }
        else if(arr[i].ShipAgent === "FedEx"){
          fxArr.push(arr[i])
          skuSplit(arr[i],"FXTable",FxCount)
          FxCount++
        }
        else{
          otherArr.push(arr[i])
        }
      }
      return otherArr
    }
    function checkSku(arr){
      let otherArr = []
      for (let i = 0; i < arr.length; i++) {
        if (arr[i].HaulInstall === true) {
          skuSplit(arr[i],"HITable",HiCount)
          HiCount++
        }
        else{otherArr.push(arr[i])}
      }
      return otherArr
    }
    function replaceZero(num){
      let final
      let compare = Number(num)
      if (compare < 1){final = 1}
      else{final = num}
      return final
    }
    function getRLRateQuoteString(obj){
      let itemArr = []
      let numItems = 0
      let poNumber
      if (obj.Product[0].PONum === undefined){
        poNumber = ""
      }
      else{
        poNumber = obj.Product[0].PONum
      }
      for(let i = 0; i < obj.Product.length;i++){
        if(String(obj.Product[i].Sku).includes("Warranty") || String(obj.Product[i].Sku).includes("HaulAwy") || String(obj.Product[i].Sku).includes("Install-") || String(obj.Product[i].PONotes).toUpperCase().includes("DS") || obj.Product[i].PONotes === undefined|| obj.Product[i].Shipped === true){
            continue
          }
          else{
            itemArr.push(`${obj.Product[i].Class}:${obj.Product[i].Weight}:${obj.Product[i].FullNMFC}:${obj.Product[i].RLSku}:${obj.Product[i].Quantity}`)
            numItems = numItems + obj.Product[i].Quantity


          }

      }
      let finalItemString = itemArr.join(";")
      let finalstring = `${obj.Customer};${obj.Address};${obj.FullZip};${obj.phone};${obj.orderNo};${poNumber};${obj.City};${obj.State};${numItems};${finalItemString}`
      return finalstring

    }
    function getFedexString(obj){
      let numItems = 0
      let itemArr = []
      for(let i = 0; i < obj.Product.length;i++){
        if(String(obj.Product[i].Sku).includes("Warranty") || String(obj.Product[i].Sku).includes("HaulAwy") || String(obj.Product[i].Sku).includes("Install-") || String(obj.Product[i].PONotes).toUpperCase().includes("DS") || obj.Product[i].PONotes === undefined|| obj.Product[i].Shipped === true){
            continue
          }
          else{
            itemArr.push(`${obj.Product[i].Quantity}:${obj.Product[i].Weight}:${Math.ceil(obj.Product[i].Depth)}:${Math.ceil(obj.Product[i].Width)}:${Math.ceil(obj.Product[i].Height)}`)
            numItems = numItems + obj.Product[i].Quantity
          }

      }
      let finalItemString = itemArr.join(";")
      let finalString = `${obj.Customer};${obj.Address};${obj.FullZip};${obj.City};${obj.State};${obj.phone};${obj.orderNo};${numItems};${finalItemString}`
      return finalString

    }
    function fedexSkuCheck(obj){
      let product = obj.Product
      let finalStatus
      for (let i = 0; i < product.length; i++) {
        if (product[i].SubCategory === "REFRIGERATOR" || product[i].SubCategory === "DISHWASHER")  {
          finalStatus = true
          break
        }
        else{
          finalStatus = false
        }
      }
      return finalStatus
    }
    function checkShipInfo(arr){
      let otherArr = []
      let SiCount = 0
      let SsCount = 0
      let RlProCount = 0
      for (let i = 0; i < arr.length; i++) {
        if(arr[i].ShipInfo.toUpperCase() === "INSIDE"){
          if(arr[i].AMQuote > arr[i].ProQuote ){
            skuSplit(arr[i],"ProTable",ProCount)
            ProCount++
          }
          else{
            skuSplit(arr[i],"AMTable",AMCount)
            AMCount++
          }
        }
        else if(arr[i].ShipInfo.toUpperCase() === "STANDARD"){
            if(arr[i].totalWeight < 75 && arr[i].totalCube < 10 && fedexSkuCheck(arr[i]) === false && arr[i].ProductWeight > 0){
              skuSplit(arr[i],"FXTable",FxCount)
              FxCount++
            }
            else{
                ssArr.push(arr[i])
                skuSplit(arr[i],"SSTable",SsCount)
                SsCount++
            }
      
        }
        else if(arr[i].ShipInfo.toUpperCase() === "FREE"){
          if(arr[i].totalWeight < 100 && fedexSkuCheck(arr[i]) === false && arr[i].ProductWeight > 0){
            skuSplit(arr[i],"FXTable",FxCount)
            FxCount++
          }
          else{otherArr.push(arr[i])}
        }
        else{otherArr.push(arr[i])}
      }
      for (let i = 0; i < otherArr.length; i++){
          skuSplit(otherArr[i],"RL/ProTable",i)
      }
    }
    function getZip(str){
        let str1 = String(str)
        let addressArr = str1.split(",")
        let zip = addressArr.pop()
        return zip
      }
    function skuSplit(obj,tableid,row){
      let product = obj.Product
      for (let i = 0; i< product.length; i++) {
        let productHead = ["AdW", "SKU", "Wt", "Category","Qty", "Class"]
        if( i === 0){
          insert_Row_Test(tableid,obj,row)
          if(product[i].Sku.includes("Warranty") || product[i].Sku.includes("HaulAwy") || product[i].Sku.includes("Install-") || product[i].PONotes.toUpperCase().includes("DS")|| product[i].Sku.includes("FME-") || product[i].Shipped === true){
            continue
          }
          else{
            skuInsertCell(tableid,row,product[i])
          }
        }
        else{
          if(product[i].Sku.includes("Warranty") || product[i].Sku.includes("HaulAwy") || product[i].Sku.includes("Install-") || product[i].PONotes.toUpperCase().includes("DS")|| product[i].Sku.includes("FME-") || product[i].Shipped === true){
            continue
          }
          else{
            skuInsertCell(tableid,row,product[i])
          }
        }
      }
    }
    function getAddress(str){
        let str1 = String(str)
        let addressArr = str1.split(",")
        let zip = addressArr.shift()
        return zip
    }
    function getDownloadString(arr){
      let downloadArr = ["Order, Zip, Weight, Cube, Margin, Price, Lareg Furniture, Bedding, Standard Furniture, Small Furniiture, Standard Apps, Pro 30, Pro 42, Pro 60, Accesories, Ship Info, Name, Address, Phone, City"]
      for( let i= 0; i < arr.length;i++){
        let obj = arr[i]
        downloadArr.push(`${obj.orderNo},${obj.Zip},${obj.totalWeight},${obj.totalCube},  ${obj.totalMargin}, ${obj.totalPrice}, ${obj.Furniture}, ${obj.Appliances}, ${obj.ShipInfo},${obj.Customer},${obj.Address},${obj.phone},${obj.City},${obj.Product[0].SubCategory}`)
      }
      let downloadString = downloadArr.join('\n')
      return downloadString
    }   
    function insert_RowObj(tableid,obj, row){
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);
      let h = x.insertCell(7);
      let i = x.insertCell(8);
      let j = x.insertCell(9);
      let k = x.insertCell(10);
      let l = x.insertCell(11);
      let m = x.insertCell(12);
      let n = x.insertCell(13);
      let col = 1
  
      a.innerHTML= `
        <div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.orderNo}',${row},${col},'${tableid}')">${obj.orderNo}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.orderNo}</span>
            </label>
        </div>`;
        col++
      b.innerHTML=`
        <div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Customer}',${row},${col},'${tableid}')">${obj.Customer}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Customer}</span>
            </label>
        </div>`;
        col++
      c.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.phone}',${row},${col},'${tableid}')">${obj.phone}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.phone}</span>
            </label>
        </div>`;
        col++
      d.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Address}',${row},${col},'${tableid}')">${obj.Address}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Address}</span>
            </label>
        </div>`;
        col++
      e.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Zip}',${row},${col},'${tableid}')">${obj.Zip}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Zip}</span>
            </label>
        </div>`;
        col++
      f.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.City}',${row},${col},'${tableid}')">${obj.City}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.City}</span>
            </label>
        </div>`;
        col++
      g.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.AmHomeZip}',${row},${col},'${tableid}')">${obj.AmHomeZip}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.AmHomeZip}</span>
            </label>
        </div>`;
        col++
      h.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.State}',${row},${col},'${tableid}')">${obj.State}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.State}</span>
            </label>
        </div>`;
        col++
      i.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Sku}',${row},${col},'${tableid}')">${obj.Sku}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Sku}</span>
            </label>
        </div>`;
        col++
      j.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalWeight}',${row},${col},'${tableid}')">${obj.totalWeight}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalWeight}</span>
            </label>
        </div>`;
        col++
      k.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalMargin}',${row},${col},'${tableid}')">${obj.totalMargin}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalMargin}</span>
            </label>
        </div>`;
        col++
      l.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.AppCar}',${row},${col},'${tableid}')">${obj.AppCar}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.AppCar}</span>
            </label>
        </div>`;
        col++
      m.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.MaxShipping}',${row},${col},'${tableid}')">${obj.MaxShipping}</button>
              <span id="${tableid}Row${row}Col" class="btn btn-primary">${obj.MaxShipping}</span>
            </label>
        </div>`;
        col++
      n.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <a href="https://admin.goedekers.com/admin/sales/order/view/order_id/${obj.EntityID}/key/${obj.MagentoKey}">Magento</a>
            </label>
        </div>`;
        

    }
    function insert_RowProfit(tableid,obj, row, costs){
      let totalProf = Number(obj.totalMargin - costs).toFixed(2)
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);
      let col = 1
      a.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.orderNo}',${row},${col},'${tableid}')">${obj.orderNo}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.orderNo}</span>
            </label>
        </div>`;
        col++
      b.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Sku}',${row},${col},'${tableid}')">${obj.Sku}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Sku}</span>
            </label>
        </div>`;
        col++
      c.innerHTML=`<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalMargin}',${row},${col},'${tableid}')">${obj.totalMargin}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalMargin}</span>
            </label>
        </div>`
        col++
      d.innerHTML=
        `<div id = "copy">
          <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${costs}</span>
        </div>`;
        col++
      e.innerHTML=`<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.ProfitGoal}',${row},${col},'${tableid}')">${obj.ProfitGoal}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.ProfitGoal}</span>
            </label>
        </div>`;
        col++
      f.innerHTML=
        `<div id = "copy">
          
          <span id="${tableid}Row${row}Col${col}">${totalProf}</span>
        </div>`;
        col++  
      g.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <a id="${tableid}Row${row}Col${col}" href="https://admin.goedekers.com/admin/sales/order/view/order_id/${obj.EntityID}/key/${obj.MagentoKey}">Magento</a>
            </label>
        </div>`
        col++  
    }
    function insert_Row_Test(tableid,obj,row){
      let col = 1
      let RLString = getRLRateQuoteString(obj)
      let fedexString = getFedexString(obj)
      let shipperstring
      let State
      if (tableid === "ProTable"){
        State = obj.ProZip
      }
      else if (tableid === "AMTable"){
        State = obj.AmHomeZip
      }
      else if (tableid === "FXTable" || tableid === "DSTable"){
        State = obj.State
        shipperstring = `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${fedexString}',${row},${col},'${tableid}')">Fedex</button>
              <span id="${tableid}Row${row}Col11" class="btn btn-primary">Fedex</span>
            </label>
        </div>`;
      }
      else if (tableid === "RLTable"){
        State = obj.State
        shipperstring = `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${RLString}',${row},${col},'${tableid}')">RL</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">RL</span>
            </label>
        </div>`;
      }
      else if (tableid === "SSTable"){
        State = obj.State
        shipperstring = `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${RLString}',${row},${col},'${tableid}')">RL</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">RL</span>
            </label>
        </div>`;
      }
      else{
        State = obj.State
      }
      let x=document.getElementById(tableid).insertRow(-1);
      x.id = `${tableid}row${row}`
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);
      let h = x.insertCell(7);
      let i = x.insertCell(8);
      let j = x.insertCell(9);
      let k = x.insertCell(10);
      let l = x.insertCell(11);
      let m = x.insertCell(12);
      

      a.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.orderNo}',${row},${col},'${tableid}')">${obj.orderNo}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.orderNo}</span>
            </label>
        </div>`;
        col++
      b.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Customer}',${row},${col},'${tableid}')">${obj.Customer}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Customer}</span>
            </label>
        </div>`;
        col++
      c.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Address}',${row},${col},'${tableid}')">${obj.Address}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Address}</span>
            </label>
        </div>`;
        col++
      d.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Zip}',${row},${col},'${tableid}')">${obj.Zip}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Zip}</span>
            </label>
        </div>`;
        col++
      e.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.phone}',${row},${col},'${tableid}')">${obj.phone}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.phone}</span>
            </label>
        </div>`;
        col++
      f.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.City}',${row},${col},'${tableid}')">${obj.City}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.City}</span>
            </label>
        </div>`;
        col++
      g.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${State}',${row},${col},'${tableid}')">${State}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${State}</span>
            </label>
        </div>`;
        col++
      h.innerHTML=`
        <table id = "${tableid}ProductRow${row}Col${col}" class="skuTable"> 
          <th class = "col1">AdW</th>
          <th class = "col2">SKU</th>
          <th class = "col3">Wt</th>
          <th class = "col4">Category</th>
          <th class = "col5">Qty</th>
          <th class = "col6">Class</th>
        </table>`;
        col++
      i.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.ProductWeight}',${row},${col},'${tableid}')">${obj.ProductWeight}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.ProductWeight}</span>
            </label>
        </div>`;
        col++
      j.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.ProductCube}',${row},${col},'${tableid}')">${obj.ProductCube}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.ProductCube}</span>
            </label>
        </div>`;
        col++
      k.innerHTML= shipperstring
        col++

      l.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <a id="${tableid}Row${row}Col${col}" href="https://admin.goedekers.com/admin/sales/order/view/order_id/${obj.EntityID}/key/${obj.MagentoKey}">Magento</a>
            </label>
        </div>`
        col++
      m.innerHTML=
        `<div class="dropdown">
          <button class="dropbtn">${obj.Carrier}</button>
          <div id="Dropdown${tableid}${row}${col}" class="dropdown-content">
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToRL('${tableid}',${row},globalObjArr)">RL</button>
                <span class="btn btn-primary">R&L:${obj.RLQuote}</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToPro('${tableid}',${row},globalObjArr)">Progistics</button>
                <span class="btn btn-primary">Progistics:${obj.ProQuote}</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToAM('${tableid}',${row},globalObjArr)">AM Home</button>
                <span class="btn btn-primary">AM Home:${obj.AMQuote}</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToFX('${tableid}',${row},globalObjArr)">FEDEX</button>
                <span class="btn btn-primary">FEDEX</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToProfit('${tableid}',${row},globalObjArr)">Profit</button>
                <span class="btn btn-primary">Profit</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToEmpty('${tableid}',${row},globalObjArr)">Empty</button>
                <span class="btn btn-primary">Empty</span>
              </label>
            </div>
          </div>
        </div>`;

    }
    function skuInsertCell(tableid,row,obj){
      let x=document.getElementById(`${tableid}ProductRow${row}Col8`).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);

      a.innerHTML=`${obj.AdWidth}`;
      b.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboardBase('${obj.RLSku}')">${obj.Sku}</button>
              <span class="btn btn-primary">${obj.Sku}</span>
            </label>
        </div>`
      c.innerHTML=`${obj.Weight}`;
      d.innerHTML=`${obj.SubCategory}`;
      e.innerHTML=`${obj.Quantity}`;
      f.innerHTML=`${obj.Class}`;
      g.innerHTML=`<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboardBase('${obj.NMFC}')">${obj.FullNMFC}</button>
              <span class="btn btn-primary">${obj.FullNMFC}</span>
            </label>
        </div>`


    }
    function openMagento(entityid){
      let magentoKey = ["b9cc24e34287219037475d8441e9fc64626e721592bc553bfb9006da85fdc253"]
      window.open(`https://admin.goedekers.com/admin/sales/order/view/order_id/${entityid}/key/${magentoKey[0]}/`)
    }   
    function shippingProfitCost(tableid,row,col,obj){
      let input = Number(document.getElementById(`${tableid}Row${row}Col${col}`).value)
      console.log(input)
      let profit = Number(obj - input)
      console.log(profit)
      let newCol = col + 2
      let ogOutput = document.getElementById(`${tableid}Row${row}Col${newCol}`)
      let parentDiv = ogOutput.parentNode
      let newspan = document.createElement("span");
      let newnode = document.createTextNode(`${profit}`);
      newspan.appendChild(newnode)
      newspan.setAttribute('id',`${tableid}Row${row}Col${newCol}`);
      newspan.setAttribute('class',"btn btn-primary");

      
      parentDiv.replaceChild(newspan,ogOutput)
    }
    function sendToRL(tableid,row,arr){
      let id =`${tableid}Row${row}Col1`
      console.log(id)
      let order = document.getElementById(`${tableid}Row${row}Col1`)
      let tableRow = document.getElementById(`${tableid}row${row}`)
      let rowIndex = tableRow.rowIndex
      let orderNum = order.innerText
      let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
      let obj = arr[objIndex]
      let rowStart = RlCount
      skuSplit(obj,"RLTable",rowStart)
      RlCount++
      document.getElementById(tableid).deleteRow(rowIndex);
      TableAmounts()
    }
    function sendToAM(tableid,row,arr){
      let newTable ="AMTable"
      let order = document.getElementById(`${tableid}Row${row}Col1`)
      let tableRow = document.getElementById(`${tableid}row${row}`)
      let rowIndex = tableRow.rowIndex
      let orderNum = order.innerText
      let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
      let obj = arr[objIndex]
      let rowStart = AMCount
      skuSplit(obj,newTable,rowStart)
      AMCount++
      document.getElementById(tableid).deleteRow(rowIndex);
      TableAmounts()
      
    }
    function sendToEmpty(tableid,row,arr){
      let newTable ="EmptyTable"
      let order = document.getElementById(`${tableid}Row${row}Col1`)
      let tableRow = document.getElementById(`${tableid}row${row}`)
      let rowIndex = tableRow.rowIndex
      let orderNum = order.innerText
      let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
      let obj = arr[objIndex]
      let rowCount = document.getElementById(newTable).rows.length;
      let rowStart = rowCount+1
      skuSplit(obj,newTable,rowStart)
      document.getElementById(tableid).deleteRow(rowIndex);
      TableAmounts()
      
    }
    function sendToProfit(tableid,row,arr){
      let newTable ="ProfitTable"
      let costs = prompt("Enter Shipping Cost");
      let order = document.getElementById(`${tableid}Row${row}Col1`)
      let tableRow = document.getElementById(`${tableid}row${row}`)
      let rowIndex = tableRow.rowIndex
      let orderNum = order.innerText
      let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
      let rowStart = rowCount+1
      insert_RowProfit(newTable,arr[objIndex], rowStart, costs)
      document.getElementById(tableid).deleteRow(rowIndex);
      TableAmounts()
    }
    function sendToPro(tableid,row,arr){
      let newTable ="ProTable"
      let order = document.getElementById(`${tableid}Row${row}Col1`)
      let tableRow = document.getElementById(`${tableid}row${row}`)
      let rowIndex = tableRow.rowIndex
      let orderNum = order.innerText
      let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
      let obj = arr[objIndex]
      let rowStart = ProCount
      skuSplit(obj,newTable,rowStart)
      ProCount++
      document.getElementById(tableid).deleteRow(rowIndex);
      TableAmounts()
    }
    function sendToFX(tableid,row,arr){
      let newTable ="FXTable"
      let order = document.getElementById(`${tableid}Row${row}Col1`)
      let tableRow = document.getElementById(`${tableid}row${row}`)
      let rowIndex = tableRow.rowIndex
      let orderNum = order.innerText
      let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
      let obj = arr[objIndex]
      let rowStart = FxCount 
      skuSplit(obj,newTable,rowStart)
      FxCount++
      document.getElementById(tableid).deleteRow(rowIndex);
      TableAmounts()
    }
    function copyToClipboard(text,iterator,column,tableid) {
      let input = document.createElement('input');
      input.setAttribute('value', text);
      document.body.appendChild(input);
      input.select();
      let result = document.execCommand('copy');
      let span = document.getElementById(`${tableid}Row${iterator}Col${column}`)
      console.log(span)
      span.style.setProperty("text-decoration", "line-through")
      copycounter =
      document.body.removeChild(input);
      return result;
    }
    function copyToClipboardBase(text) {
      let input = document.createElement('input');
      input.setAttribute('value', text);
      document.body.appendChild(input);
      input.select();
      let result = document.execCommand('copy');
      document.body.removeChild(input);
      return result;
    }
    function copyFedexToClipboard(text,iterator) {
      let input = document.createElement('input');
      input.setAttribute('value', text);
      document.body.appendChild(input);
      input.select();
      let result = document.execCommand('copy');
      let span = document.getElementById(`copy${iterator}Fedex`)
      console.log(span)
      span.style.setProperty("text-decoration", "line-through")
      document.body.removeChild(input);
      return result;
    }
    function openCity(evt, cityName) {
      let i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(cityName).style.display = "block";
      evt.currentTarget.className += " active";
    }
    function strToArr( strData, strDelimiter ){
        strDelimiter = (strDelimiter || ",");
        let objPattern = new RegExp(
            (
                "(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +
                "(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +
                "([^\"\\" + strDelimiter + "\\r\\n]*))"
            ),
            "gi"
            );
        let arrData = [[]];
        let arrMatches = null;
        while (arrMatches = objPattern.exec( strData )){
            let strMatchedDelimiter = arrMatches[ 1 ];
            if (strMatchedDelimiter.length && strMatchedDelimiter !== strDelimiter){
                arrData.push( [] );
            }
            let strMatchedValue;
            if (arrMatches[ 2 ]){
                strMatchedValue = arrMatches[ 2 ].replace(
                    new RegExp( "\"\"", "g" ),
                    "\""
                    );
            } 
            else {
                strMatchedValue = arrMatches[ 3 ];
            }
            arrData[ arrData.length - 1 ].push( strMatchedValue );
        }
        return( arrData );
    }
    function csvToArray(str, delimiter = ",") {
      let rowArr = strToArr(str)
      console.log(rowArr)
      let finalObjArr  = getObjArray(rowArr)
      console.log(finalObjArr)
      let afterpo = checkPO(finalObjArr)
      let afterLocal = checkLocal(afterpo)
      let afterSku = checkSku(afterLocal)
      let afterAgent = checkAgent(afterSku)
      let afterShipInfo = checkShipInfo(afterAgent)
      let downloadString = getDownloadString(ssArr)
      TableAmounts()
      // download(downloadString, `ready to ship.csv`,csvFile)
      // console.log(amArr)
      // console.log(fxArr)
      // console.log(proArr)
      // console.log(rlArr)
      // console.log(dsArr)
    }
    function download(data, filename, type) {
      let file = new Blob([data], {type: type});
      if (window.navigator.msSaveOrOpenBlob) // IE10+
          window.navigator.msSaveOrOpenBlob(file, filename);
      else { // Others
          var a = document.createElement("a"),
                  url = URL.createObjectURL(file);
          a.href = url;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          setTimeout(function() {
              document.body.removeChild(a);
              window.URL.revokeObjectURL(url);  
          }, 0); 
      }
    }
    function getskuArr(arr1,arr2){
      skuArr = []
      if(arr1[0] === arr2[0]){
        skuArr.push(arr1[10])
      }
      return skuArr
    }
    function getProWCharge(Zip,Weight,Cube,deliveryCharge,dist){
      let weightindex = getProWeight(Weight,Cube)
      let miles
      if (dist === "N/A") {miles = "CQN"}
        else{miles = Math.floor((Number(dist)/300))}
      let chargeArr = proGridMapper(weightindex)
      let chargeval = chargeArr[miles]
      let basecharge = (Number(chargeval) * 1.09) + 73
      let willCallCharge = Number(basecharge + deliveryCharge).toFixed(2)
      return willCallCharge
    }
    function getProWeight(Weight,Cube){
      let weight
      if(Weight > (Cube * 4)){weight = Weight}
        else{weight = (Cube * 4)}
        weightindex = Math.floor(Number(weight)/100) + 1
        return weightindex
      }
    function getRLClass(ht,wt,subcat){
          let RLClass
          if(wt <= 10){
              RLClass = 70
            }      
          else if(RlClassMapper(subcat) === "Density"){
            let height = (ht + 6)/12
            let width = 40/12
            let length = 48/12
            let weight = wt + 40
            let volume = (length * width * height)
            let density = weight/volume
            
            if (density >= 30){
              RLClass = 60
            }
            else if (density >= 22.5 && density < 30){
              RLClass = 65
            }
            else if (density >= 15 && density < 22.5){
              RLClass = 70
            }
            else if (density >= 12 && density < 15){
              RLClass = 85
            }
            else if (density >= 10 && density < 12){
              RLClass = 92.5
            }
            else if (density >= 8 && density < 10){
              RLClass = 100
            }
            else if (density >= 6 && density < 8){
              RLClass = 125
            }
            else if (density >= 4 && density < 6){
              RLClass = 175
            }
            else if (density >= 2 && density < 4){
              RLClass = 250
            }
            else if (density >= 1 && density < 2){
              RLClass = 300
            }
            else if (density < 1){
              RLClass = 400
            }
          }
          else{
            interArr = (RlClassMapper(subcat))
            RLClass = interArr[0]
          }
          return RLClass
        }
    function getShipInfo(str){
      let preShip = String(str)
      let shipInfo
        if (preShip.toUpperCase().includes("INSIDE")) {
          shipInfo = "Inside"
        }
        else if (preShip.toUpperCase().includes("LOCAL") || preShip.toUpperCase().includes("TERRY") ) {
          shipInfo = "Local"
        }
        else if (preShip.toUpperCase().includes("PICK UP")) {
          shipInfo = "Pick Up"
        }
        else if (preShip.toUpperCase().includes("STANDARD DELIVERY")) {
          shipInfo = "Standard"
        }
        else if (preShip.toUpperCase().includes("FREE")) {
          shipInfo = "Free"
        }
        else{
          shipInfo = "Unknown"
        }
      return shipInfo  
    }
    function checkUndefined(str){
      let fixedstr = String(str).replace(/['"]+/g, '')
      let poitem 
      if (fixedstr === undefined){
        poitem = ""
      }
      else{
        poitem = fixedstr
      }
      return poitem
    }
    function getLowest(num1, num2){
      let lowest 
        if (Number(num1) > Number(num2) && Number(num2) > 0){
          lowest = Number(num2)
        }
        else{
          lowest = (Number(num1))
        }
        return lowest
    }
    function getSubcat(str){
      let preSubCat = String(str).split(" ")
        let midSubCat
        let interText
        if(preSubCat[0] === "Wall" || preSubCat[0] === "Ice" || preSubCat[0] === "Trash" || preSubCat[0] === "Water"){
          midSubCat = String(preSubCat[0] + " " + preSubCat[1])
        }
        else{
          midSubCat = String(preSubCat[0]).replace(/['"]+/g, '')
        }
        if(String(midSubCat).slice(-1).toLowerCase() === "s"){
          let text = String(midSubCat).toUpperCase()
          interText = text.slice(0, -1)
        }
        else{
          interText = midSubCat.toUpperCase()
        }

        let finalText = String(interText)


        return finalText
    }
    function pad(num, size) {
      num = String(num)
      while (num.length < size) num = "0" + num;
      return num;
    }    
    function getNMFC(Category,weight){
      let rawNMFC = String(RlClassMapper(Category))
      let NMFCsplit = rawNMFC.split(",")
      let interNMFC = Number(NMFCsplit[1])
      let partialNMFC = pad(interNMFC, 6)
      let NMFCcode
      if (weight <= 10) {
        NMFCcode = 095190  
      }
      else  if (partialNMFC === "000NaN") {
        NMFCcode = "No NMFC"        
      }
      else{
        NMFCcode = partialNMFC
      }
      return NMFCcode
    }
    function getNMFCsub(Category, weight){
      let rawNMFC = String(RlClassMapper(Category))
      let NMFCsplit = rawNMFC.split(",")
      let NMFCcode
      
      if (weight <= 10){NMFCcode = `/9`}
      else if (NMFCsplit[2] === undefined){
        NMFCcode = ""
      } 
      else{
        NMFCcode = `/${NMFCsplit[2]}`
      }
      return NMFCcode
    }
    function checkNMFC(str){
      let finalStr
      if (str === "000NaN" || str === undefined) {
        finalStr = "N/A"
        
      }
    }
    function AmLargeBoxSurcharge(Weight,Furniture,Appliances){
      let furnArr = String(Furniture).split(",")
      let largeBox = Number(furnArr[0])
      let bedBox = Number(furnArr[1])
      let standBox = Number(furnArr[2])
      let smallBox = Number(furnArr[3])
      let appArr = String(Appliances).split(",")
      let standApp = Number(appArr[0])
      let Pro30 = Number(appArr[1])
      let Pro40 = Number(appArr[2])
      let Pro60 = Number(appArr[3])
      let proSum = (Pro30 + Pro40 + Pro60)
      let lrgBoxCharge
      let weightcalc
      let compareString = Weight/(Math.ceil(largeBox + bedBox + standBox + smallBox))
      if (proSum === 0 && largeBox > 0) {lrgBoxCharge = 25}
        else{lrgBoxCharge = 0}
      if (compareString > 500) {weightcalc = 500}
      else if (compareString > 500) {weightcalc = 500}
      else if (compareString > 450) {weightcalc = 450}
      else if (compareString > 400) {weightcalc = 400}
      else if (compareString > 350) {weightcalc = 350}
      else if (compareString > 300) {weightcalc = 300}
      else{weightcalc = 0}
      let total = lrgBoxCharge + weightcalc
      return total
    }
    function AMLMQuote(Zip,AMZip,Appliances){
      let appArr = String(Appliances).split(",")
      let standApp = Number(appArr[0])
      let Pro30 = Number(appArr[1])
      let Pro40 = Number(appArr[2])
      let Pro60 = Number(appArr[3])
      let AMLMMap = amQMapper(Zip)[1]
      let FinalMile 
      
      if(Pro30 > 0 || Pro40 >0 || Pro60 >0 ){
            if(AMZip=== "NY"){

                FinalMile = (Pro60 * 335) + (Pro40 * 260) + (Pro30 * 185)
            }
            else{
                FinalMile = (Pro60 * 460) + (Pro40 * 385) + (Pro30 * 310)
            }   
        }
        else{
          FinalMile = AMLMMap
        }
      return FinalMile
    }
    function AMNYQuote(Zip,AMZip,Appliances){
      let appArr = String(Appliances).split(",")
      let standApp = Number(appArr[0])
      let Pro30 = Number(appArr[1])
      let Pro40 = Number(appArr[2])
      let Pro60 = Number(appArr[3])
      let AMNYMap = amQMapper(Zip)[2]
      let NYTransfer
      if(Pro30 > 0 || Pro40 >0 || Pro60 >0 ){
          if(AMZip === "NY"){

              NYTransfer = (Pro60 * 335) + (Pro40 * 260) + (Pro30 * 185)
          }
          else{
              NYTransfer = (Pro60 * 460) + (Pro40 * 385) + (Pro30 * 310)
          }   
      }
      else{
        NYTransfer = AMNYMap
      }
      return NYTransfer
    }
    function AMCAQuote(Zip,AMZip,Appliances){
      let CATransfer
      let appArr = String(Appliances).split(",")
      let standApp = Number(appArr[0])
      let Pro30 = Number(appArr[1])
      let Pro40 = Number(appArr[2])
      let Pro60 = Number(appArr[3])
      let AMCAMap = amQMapper(Zip)[0]
      if (AMCAMap != "No")  {
          if (Pro30 > 0 || Pro40 > 0 || Pro60 > 0) {
            CATransfer = (Pro60 * 460) + (Pro40 * 385) + (Pro30 * 310)
          }
          else{CATransfer = AMCAMap}
          
        }
        else{CATransfer = 100000}
      return  CATransfer
    }
    function AmAddedBoxes(Furniture,Appliances){
    let furnArr = String(Furniture).split(",")
    let largeBox = Number(furnArr[0])
    let bedBox = Number(furnArr[1])
    let standBox = Number(furnArr[2])
    let smallBox = Number(furnArr[3])
    let appArr = String(Appliances).split(",")
    let standApp = Number(appArr[0])
    let Pro30 = Number(appArr[1])
    let Pro40 = Number(appArr[2])
    let Pro60 = Number(appArr[3])
    let proSum = (Pro30 + Pro40 + Pro60)
    let addedBoxCharge
    if(proSum > 0){
       let arg1 = (largeBox * 75)
       let arg2
       let arg3
       let arg4
       let arg5 = (smallBox *20)
        if (bedBox > 0) {
            if (bedBox > 4) {arg2 = (bedBox - 3) * 40}
                else{arg2 = 40}
        }
            else{arg2 = 0}
        if (standBox > 0) {arg3 = (standBox-1) * 40}
            else{arg3 = 0}
        if(standApp > 0){arg4 = (standApp - 1) * 40} 
            else{arg4 = 0}   
        addedBoxCharge = arg1 + arg2 + arg3 + arg4 + arg5   
    }
    else{
        let arg1 
        if (largeBox > 0) {
            let arg1 = (largeBox-1) * 75 
            let arg2
            let arg3
            let arg4
            let arg5 = (smallBox *20)
            if (bedBox > 0) {
                if (bedBox > 4) {arg2 = (bedBox - 3) * 40}
                    else{arg2 = 40}
            }
                else{arg2 = 0}
            if (standBox > 0) {arg3 = (standBox-1) * 40}
                else{arg3 = 0}
            if(standApp > 0){arg4 = (standApp - 1) * 40} 
                else{arg4 = 0}
        addedBoxCharge = arg1 + arg2 + arg3 + arg4 + arg5
        }
        else if(bedBox >0){
            let arg1 = 0
            let arg2
            let arg3
            let arg4
            let arg5 = (smallBox *20)
            if (bedBox > 4) {arg2 = (bedBox - 4) * 40}
                else{arg2 = 0}
            if (standBox > 0) {arg3 = standBox * 40}
                else{arg3 = 0}
            if(standApp > 0){arg4 = standApp * 40} 
                else{arg4 = 0}
            addedBoxCharge = arg1 + arg2 + arg3 + arg4 + arg5       
        }
        else if(standBox > 0){
            let arg1 = 0
            let arg2 = 0
            let arg3
            let arg4
            let arg5
            if (standBox > 1) {arg3 = (standBox -2 ) * 40}
                else{arg3 = 0}
            if(standApp > 0){arg4 = standApp * 40} 
                else{arg4 = 0}
            if(smallBox > 0){arg5 =smallBox * 20}
                else{arg5 = 0}
            addedBoxCharge = arg1 + arg2 + arg3 + arg4 + arg5       
        }
        else if(standApp > 0){
            let arg1 = 0
            let arg2 = 0
            let arg3 = 0
            let arg4
            let arg5
            if(standApp > 1){arg4 = (standApp - 2) * 40} 
                else{arg4 = 0}
            if(smallBox > 0){arg5 =smallBox * 20}
                else{arg5 = 0}
            addedBoxCharge = arg1 + arg2 + arg3 + arg4 + arg5       
        }
    }
    return addedBoxCharge
}
    function checkShipped(qty,ship,refund){
      let num = Number(ship) + Number(refund)
      if(num >= qty){return true}
       else {return false}
}
    function newProd(arr, i){
      let previous = arr[i]
      let cost = getLowest(previous[13],previous[25])
      let price = Number(previous[14])
      let sku = previous[10]
      let weight = (Math.ceil(Number(previous[11])))
      let cat = previous[19]
      let qty = (Number(previous[23]))
      let subcat = getSubcat(previous[20])
      let poNotes = checkUndefined(previous[9])
      let poNum = checkUndefined(previous[22])
      let adWidth = checkUndefined(previous[21])
      let ht = checkUndefined(previous[16])
      let width = checkUndefined(previous[17])
      let depth = checkUndefined(previous[18])
      let rlSku = String(sku) + "-" +String(subcat)
      let rlClass = getRLClass(ht,weight,subcat)
      let shipped = checkShipped(qty,previous[27],previous[28])
      let newItem = new Product(poNotes,sku,weight,cost,ht,width,depth,price,cat,subcat,adWidth,qty,poNum,rlClass,shipped)
      return newItem
    }
    function getObjArray(arr){
        let objArr = []
        let productArr = []
        for(let i = 1; i < arr.length; i++){
            let previous = arr[i] 
            let l = i+1
            let next = arr[l]
            let ifMore
            if (next === undefined){
              ifMore = false
            }
            else{
              ifMore = arr.some(order => `${next[0]}` === `${previous[0]}`)
            }
            let ifDupe = objArr.some(obj => obj.orderNo === `${previous[0]}`)
            
            if (ifMore === true){
              let newItem = newProd(arr,i)
              // console.log(`IfDupe: ${ifDupe}`)
              // console.log(`IfMore: ${ifMore}`)
              productArr.push(newItem)
            }
            else if (ifMore === false){
              let newItem = newProd(arr,i)
              // console.log(`IfDupe: ${ifDupe}`)
              // console.log(`IfMore: ${ifMore}`)
              // console.log(newItem)
              productArr.push(newItem)
              let order = previous[0]
              let name = String(`${previous[1]} ${previous[2]}`)
              let address = String(`${previous[4]} ${previous[5]}`)
              let phone = previous[3]
              let rawZip = String(previous[7]).split("-")
              let zip = rawZip[0]
              let state = previous[8]
              let product = productArr
              let shipInfo = getShipInfo(previous[12])
              let shipAgent = previous[15]
              let entityid = Number(previous[24])
              let city = previous[6]
              let paidShip = Number(previous[26])
              if(city === undefined){
                productArr = [] 
                continue
              }
              else{
              let orderObj = new Line(order,name,address,phone,zip,state,shipAgent,shipInfo,city,product,entityid,paidShip)
              objArr.push(orderObj)
              globalObjArr.push(orderObj)
              productArr = []
              }
            }



            // console.log(orderObj)
            // console.log(orderObj.orderNo)
            
        }
        
        return objArr
    }
    class Product{
      constructor(PONotes,Sku,Weight,Cost,Height,Width,Depth,Price,Category,SubCategory,AdWidth,Quantity,PONum,Class,Shipped){
        this.PONotes = PONotes
        this.Sku = Sku
        this.Weight =  Number(Number(Weight).toFixed(1))
        this.Cost = Cost
        this.Margin = Number(Number(Price - Cost).toFixed(2)) 
        this.Height = Number(Number(replaceZero(Height)).toFixed(1))
        this.Width = Number(Number(replaceZero(Width)).toFixed(1))
        this.Depth  = Number(Number(replaceZero(Depth)).toFixed(1))
        this.Price = Price
        this.Category = Category
        this.SubCategory = SubCategory
        this.AdWidth = AdWidth
        this.Quantity = Quantity
        this.PONum = PONum
        this.NMFC = getNMFC(SubCategory,Number(Number(Weight).toFixed(1)))
        this.NMFCsub = getNMFCsub(SubCategory,Weight)
        this.FullNMFC = `${this.NMFC}${this.NMFCsub}`
        this.Class = Class
        this.Cube = Math.ceil((Height/12)*(Width/12)*(Depth/12))
        this.Shipped = Shipped
        this.isPart = partMapper(Sku)
      }
      get DimensionalWeight(){
        return this.getDimWeight(this.Weight,this.Width,this.Height,this.Depth)
      }
      get Oversized(){
        return this.getOversized(this.Weight,this.Width,this.Height,this.Depth)
      }
      get RLSku(){
        return this.getRLSku(this.Sku,this.SubCategory,this.isPart)
      }
      getRLSku(sku,subcat,partcheck){
        if (partcheck === true) {return `${sku}`}
        else if (subcat === "VENTILATION") {return `${sku}-RANGEHOOD`}
        else{return `${sku}-${subcat}`}
      }
      getDimWeight(Weight,Width,Height,Length){
       let cube = (Width * Height * Length)
       let dimWeight = cube/166
       let subfinal = Math.max(Weight,dimWeight)
       let final = subfinal.toFixed(1)
       return final
      }
      getOversized(Weight,Width,Height,Length){
       let cube = (Width * Height * Length)
       let dimWeight = cube/166
       let subfinal = Math.max(Weight,dimWeight)
       let shipWeight = subfinal.toFixed(1)
       let cubeft = cube/1728
       let oversized
       if (cubeft <= 3) {return false}
       else if((Length + Width) > 130 || shipWeight > 75 ){return true}
       else if((Length + Width) > 165 || Length > 108 || shipWeight > 150 ){return "DNS"}
       else{return false}
      }
    }
    class Line{
      constructor(orderNo,Customer,Address,phone,Zip,State,ShipAgent,ShipInfo,City,Product,EntityID,ShipPaid){
        this.orderNo = String(orderNo).replace(/['"]+/g, '')
        this.Customer = String(Customer).replace(/['"]+/g, '')
        this.Address = String(Address).replace(/['"]+/g, '')
        this.phone = String(phone).replace(/['"]+/g, '')
        this.Zip = Number(Zip)
        this.FullZip = pad(Zip,5)
        this.AmHomeZip = amHomeMapper(Number(Zip))
        this.ProZip = ProMapper(Number(Zip))
        this.State = String(State).replace(/['"]+/g, '')
        this.FullState = stateMapper(State)
        this.ShipAgent = String(ShipAgent).replace(/['"]+/g, '')
        this.ShipInfo = String(ShipInfo).replace(/['"]+/g, '')
        this.City = String(City).replace(/['"]+/g, '')
        this.Product = Product
        this.EntityID = EntityID
        this.MagentoKey = "b9cc24e34287219037475d8441e9fc64626e721592bc553bfb9006da85fdc253"
        this.ShipPaid = ShipPaid
      }
      get totalWeight(){
        return this.getProductWeight(this.Product)
      }
      get totalCost(){
        return this.getProductCost(this.Product)
      }
      get ProductWeight(){
        return this.getFilteredProductWeight(this.Product)
      }
      get ProductCube(){
        return this.getFilteredProductCube(this.Product)
      }
      get NumItems(){
        return this.getNumItems(this.Product)
      }
      get totalPrice(){
        return this.getProductPrice(this.Product)
      }
      get totalMargin(){
        return this.getProductMargin(this.Product)
      }
      get totalCube(){
        return this.getProductCube(this.Product)
      }
      get Appliances(){
        return this.getStandardApp(this.Product)
      }
      get Furniture(){
        return this.getSmallFurn(this.Product)
      }
      get prodWeight(){
        return this.getProductWeight(this.Product)
      }
      get ProfitGoal(){
        return this.getProfitGoal(this.totalPrice)
      }
      get MaxShipping(){
        return this.getMaxShipping(this.totalPrice,this.totalMargin,this.ShipPaid)
      }
      get AmTransfer(){
        return this.getAMTransfer(this.Appliances,this.Zip,this.AmHomeZip)
      }
      get AMQuote(){
        return this.getAMQuote(this.Zip,this.Weight,this.AmHomeZip,this.Furniture,this.Appliances)
      }
      get RLQuote(){
        return this.getRLQuote(this.Zip,this.ProductWeight,this.Furniture)
      }
      get ProQuote(){
        return this.getProQuote(this.Zip,this.totalWeight,this.totalCube)
      }
      get Carrier(){
        return this.getCarrier(this.AMQuote,this.ProQuote,this.RLQuote)
      }
      get HaulInstall(){
        return this.getHI(this.Product)
      }
      get Local(){
        return this.getLocal(this.ShipInfo,this.Address)
      }
      get DS(){
        return this.getDS(this.Product)
      }
      get isXPO(){
        return this.getIsXPO(this.Zip)
      }
      getIsXPO(Zip){
        if (XPOMapper(Zip) != "N/A"){return true}
          else{return false}
      }
      getCarrier(AM,Pro,RL){
        let AMQuote
        let ProQuote
        let RLQuote
        let carrier
        if (AM === undefined || AM === "NaN" || AM === "O/A") {AMQuote = 100000}
          else{AMQuote = AM}
        if (Pro === undefined || Pro === "NaN") {ProQuote = 100000}
          else{ProQuote = Pro}  
        if (RL === undefined || Number(RL) === NaN) {RLQuote = 100000}
          else{RLQuote = RL}
        if (RLQuote < AMQuote && RLQuote < ProQuote) {
          carrier = "R&L"
        }
        else if (AMQuote < RLQuote && AMQuote < ProQuote) {
          carrier = "AM Home"
        }
        else if (ProQuote < RLQuote && ProQuote < AMQuote) {
          carrier = "Progistics"
        }
        return carrier
      }
      getDS(arr){
        let status  
        for(let i = 0;i < arr.length;i++){
          if (String(arr[i].PONotes).toUpperCase().includes("DS")) {
            return true
          }
          else{
            status = false
          }
        }
        return status
      }
      getLocal(shipInfo,address){
        let status  
          if (shipInfo === "Pick Up" || address.toUpperCase().includes("3817 MILLSTONE")) {
            return true
          }
          else{
            return false
          }
        }
      getHI(arr){
        let status  
        for(let i = 0;i < arr.length;i++){
          if (String(arr[i].Sku).includes("Install-") || String(arr[i].Sku).includes("HaulAwy")) {
            return true
          }
          else{
            status = false
          }
        }
        return status
      }
      getProQuote(Zip,Weight,Cube){
      let ProArr = proMasterMapper(Zip)
      let miles = Number(ProArr[4])
      let tlCheck = ProArr[1]
      let tlCost = ProArr[0]
      let deliveryCharge = Number(ProArr[3])
      let willCallCharge = getProWCharge(Zip,Weight,Cube,deliveryCharge,miles)
      let finalQuote
      if (tlCheck === "Yes") {finalQuote = tlCost}
        else{finalQuote = willCallCharge}
      return finalQuote
      }
      getRLQuote(Zip,Weight,Furniture){
        let RlMapArr = RLMasterMapper(Zip)
        let furnArr = String(Furniture).split(",")
        let largeBox = Number(furnArr[0])
        let ifarg
        let final
        let fee = Number(RlMapArr[5])
        let arg2 =  Number(RlMapArr[2])
        let arg3 =  Number(RlMapArr[1])
        if (largeBox > 0) {ifarg =  Number(RlMapArr[4])}
          else{ifarg =  Number(RlMapArr[3])}
        let arg1 = ((Number(Weight) + 40)/100) *  Number(ifarg)
        let MAX = Math.max(arg1,arg2)*Number((100-RlMapArr[0])/100)
        let subtotal = Math.max(MAX,arg3)
        let pretotal = Number(subtotal * 1.18)
        let total = (Number(pretotal) + fee + 25).toFixed(2)
        if(total === undefined || total === NaN){final = "N/A"}
          else{final = total}
        return Number(final)
      }
      getAMQuote(Zip, Weight,AmZip,Furniture,Appliances){
      
      let baseQuote
      let addedBoxCharge = AmAddedBoxes(Furniture,Appliances)
      let lrgBoxCharge = AmLargeBoxSurcharge(Weight,Furniture,Appliances)
      let subtotal
      let total
      let AmTransfer
      if (amMasterMapper(Zip) > 9990){
        AmTransfer = " "
      }
      else{
        if (AmZip === "CA" || AmZip === "CAO" || AmZip === "DAL2" || AmZip === "GA" || AmZip === "IA" || AmZip === "IAO" || AmZip === "MA" || AmZip === "MAO" || AmZip === "MD" || AmZip === "NH" || AmZip === "NY" || AmZip === "OH") {
          AmTransfer = "Truckload"
        }
        else{
          if (AMNYQuote(Zip,AmZip,Appliances) < AMCAQuote(Zip,AmZip,Appliances)) {
            AmTransfer = "NY Transfer"
          }
          else{AmTransfer = "CA Transfer"}
        }
      }
      if (AmZip === "Outside Area"){
        total = "O/A"
      }
      else if (AmTransfer === "NY Transfer") {
        baseQuote = AMNYQuote(Zip,AmZip,Appliances)
        subtotal = baseQuote + addedBoxCharge + lrgBoxCharge
        total = Number((subtotal * 0.04) + subtotal).toFixed(2)
      }
      else if (AmTransfer === "CA Transfer") {
        baseQuote = AMCAQuote(Zip,AmZip,Appliances)
        subtotal = baseQuote + addedBoxCharge + lrgBoxCharge
        total = Number((subtotal * 0.04) + subtotal).toFixed(2)
      }
      else if (AmTransfer === "Truckload") {
        baseQuote = AMLMQuote(Zip,AmZip,Appliances)
        subtotal = baseQuote + addedBoxCharge + lrgBoxCharge
        total = Number((subtotal * 0.04) + subtotal).toFixed(2)
      }
      else{
        baseQuote ="N/A"
      }
      return total
    }
      getAMTransfer(Appliances,Zip,AmHomeZip){
        let AmTransfer
        if (amMasterMapper(Zip) > 9990){
          AmTransfer = ""
        }
        else{
          if (AmHomeZip === "CA" || AmHomeZip === "CAO" || AmHomeZip === "DAL2" || AmHomeZip === "GA" || AmHomeZip === "IA" || AmHomeZip === "IAO" || AmHomeZip === "MA" || AmHomeZip === "MAO" || AmHomeZip === "MD" || AmHomeZip === "NH" || AmHomeZip === "NY" || AmHomeZip === "OH") {
            AmTransfer = "Truckload"
          }
          else{
            if (AMNYQuote(Zip,AmHomeZip,Appliances) < AMCAQuote(Zip,AmHomeZip,Appliances)) {
              AmTransfer = "NY Transfer"
            }
            else{AmTransfer = "CA Transfer"}
          }
        }

        return AmTransfer
      }
      getMaxShipping(Price, Margin, ShipPaid){
        let requiredProfit = Price * 0.1
        let newMargin = Number(Margin + ShipPaid)
        let maxship = Number(newMargin - requiredProfit).toFixed(2)
        return maxship
      }
      getProfitGoal(Price){
        let requiredProfit = Number(Price * 0.1).toFixed(2)
        return requiredProfit
      }
      getProductWeight(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + (arr[i].Weight * arr[i].Quantity)
        }
        return counter
      }
      getNumItems(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          if(arr[i].Sku.includes("Warranty") || arr[i].Sku.includes("HaulAwy") || arr[i].Sku.includes("Install-") || arr[i].PONotes.toUpperCase().includes("DS")|| arr[i].Sku.includes("FME-")){
            continue
          }
          else{
            counter = counter + arr[i].Quantity
          }
        
        }
        return counter
      }
      getFilteredProductWeight(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          if(arr[i].Sku.includes("Warranty") || arr[i].Sku.includes("HaulAwy") || arr[i].Sku.includes("Install-") || arr[i].PONotes.toUpperCase().includes("DS") || arr[i].Sku.includes("FME-") || arr[i].Shipped === true){
            continue
          }
          else{
            counter = counter + (arr[i].Weight * arr[i].Quantity)
          }
        
        }
        return counter
      }
      getFilteredProductCube(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          if(arr[i].Sku.includes("Warranty") || arr[i].Sku.includes("HaulAwy") || arr[i].Sku.includes("Install-") || arr[i].PONotes.toUpperCase().includes("DS") || arr[i].Sku.includes("FME-") || arr[i].Shipped === true){
            continue
          }
          else{
            counter = counter + (arr[i].Cube * arr[i].Quantity)
          }

        }
        return counter
      }
      getProductPrice(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + (arr[i].Price * arr[i].Quantity)
        }
        return counter
      }
      getProductCost(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + (arr[i].Cost * arr[i].Quantity)
        }
        return counter
      }       
      getProductMargin(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + (arr[i].Margin * arr[i].Quantity)
        }
        return counter
      }
      getProductCube(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + (arr[i].Cube * arr[i].Quantity)
        }
        return counter
      }
      getSmallFurn(arr){
        let smallFurn = 0
        let largeFurn = 0
        let bedding = 0 
        let standFurn = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          let subCat = obj.SubCategory.toLowerCase()
          let cat = obj.Category.toLowerCase()
          if(cat.toUpperCase() === "FURNITURE"){
            if(cat.includes("bed")){
              bedding++
            }
            else{
              if(obj.Width > 80 || obj.Height > 80 || obj.Depth > 80 || subCat.includes("sofa")){
                largeFurn++
              }
              else{
                if(obj.Weight <= 40 ){
                  smallFurn++
                }
                else{
                  standFurn++
                }
              }
            }
          }
          else{
            continue
          }
        }
        let finalString = (`${largeFurn}, ${bedding}, ${standFurn}, ${smallFurn}`)
        return finalString
      }
      getStandardApp(arr){
        let standardCounter = 0
        let pro30Counter = 0
        let pro42Counter = 0
        let pro60Counter = 0
        let accCounter = 0 
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          if(obj.Category.toUpperCase() === "FURNITURE" || obj.Sku.includes("Warranty")){
            continue
          }
          else{
            if(obj.Weight < 20 ){
              accCounter++            
            }
            else{
              if(obj.AdWidth >= 30 && obj.AdWidth <= 36){
                pro30Counter++
              }
              else if(obj.AdWidth >= 42 && obj.AdWidth <= 48){
                pro42Counter++
              }
              else if(obj.AdWidth >= 60){
                pro60Counter++
              }
              else{
                standardCounter++
              }

            }
          }
        }
        let finalString = (`${standardCounter}, ${pro30Counter}, ${pro42Counter}, ${pro60Counter}, ${accCounter}`)
      return finalString
      }
    }
    myForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const input = csvFile.files[0];
      const reader = new FileReader();
      reader.onload = function (e) {
        const text = e.target.result;
        const data = csvToArray(text);
      };
      reader.readAsText(input);
    });
  </script>
</body>