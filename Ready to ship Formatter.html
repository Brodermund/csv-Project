<head> 
  <link rel="stylesheet" href="styles.css">
  <script src="AMHome.js"></script>
  <script src="LocalZip.js"></script>
  <script src="RLClass.js"></script>
  <script src="Progistics.js"></script>
</head>
<style>
</style>
<body>
  <form id="myForm">
    <div id="filePicker" >
      <label>
        <input type="file" id="csvFile" accept=".csv" />
        <span id="file-name-upload" class="btn btn-primary">Click here to open file</span>
      </label>
    </div>
    <div id="sumbitButton">
      <label>
        <input type="submit" id="submit" value="Submit" />
        <span class="btn btn-primary">Submit & Download</span>
      </label>
    </div>
  </form>
  <div class="tab">
    <button class="tablinks" onclick="openCity(event, 'AMHOME')" id="defaultOpen">AMHOME</button>
    <button class="tablinks" onclick="openCity(event, 'PROGISTICS')">PROGISTICS</button>
    <button class="tablinks" onclick="openCity(event, 'FEDEX')">FEDEX</button>
    <button class="tablinks" onclick="openCity(event, 'RL')">R&L</button>
    <button class="tablinks" onclick="openCity(event, 'DROPSHIP')">DROP SHIP</button>
    <button class="tablinks" onclick="openCity(event, 'HaulInstall')">Haul/Install</button>
    <button class="tablinks" onclick="openCity(event, 'ShipStandard')">Ship Standard</button>
    <button class="tablinks" onclick="openCity(event, 'ShipInside')">Ship Inside</button>
    <button class="tablinks" onclick="openCity(event, 'ShipFree')">Profit</button>
    <button class="tablinks" onclick="openCity(event, 'OtherTab')">RL Quote</button>
    <button class="tablinks" onclick="openCity(event, 'RL/Progistics')">Rl/Pro</button>
    <button class="tablinks" onclick="openCity(event, 'LocalTab')">Local</button>
  </div>
  <div id="AMHOME" class="tabcontent">
    <table id="AMTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="PROGISTICS" class="tabcontent">
    <table id="ProTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="RL" class="tabcontent">
    <table id="RLTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="FEDEX" class="tabcontent">
    <table id="FXTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="DROPSHIP" class="tabcontent">
    <table id="DSTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="HaulInstall" class="tabcontent">
    <table id="HITable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="ShipStandard" class="tabcontent">
    <table id="SSTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="ShipInside" class="tabcontent">
    <table id="SITable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="ShipFree" class="tabcontent">
    <table id="ProfitTable">
      <tr id="header">
        <th>Order Number</th>
        <th>SKU</th>
        <th>Margin</th>
        <th>Ship Cost</th>
        <th>10% Goal</th>
        <th>Profit</th>
      </tr>
    </table>
  </div>
  <div id="OtherTab" class="tabcontent">
    <table id="RLQuote">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="RL/Progistics" class="tabcontent">
    <table id="RL/ProTable">
      <tr id="header">
        <th>Order#</th>
        <th>Customer</th>
        <th>Address</th>
        <th>Phone</th>
        <th>Zip</th>
        <th>City</th>
        <th>AMZ</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Cube</th>
        <th>PO#</th>
        <th>MaxShip</th>
        <th>Link</th>
        <th>Direct</th>
      </tr>
    </table>
  </div>
  <div id="LocalTab" class="tabcontent">
    <table id="LocalTable">
      <tr id="header">
        <th>Order Number</th>
        <th>Customer</th>
        <th>Phone</th>
        <th>Address</th>
        <th>Zip Code</th>
        <th>City</th>
        <th>AM Zone</th>
        <th>State</th>
        <th>SKU</th>
        <th>Weight</th>
        <th>Margin</th>
        <th>ShipInfo</th>
        <th>Shipping Agent</th>
      </tr>
    </table>
  </div>
  <script> 
    document.getElementById("defaultOpen").click();
    const reducer = (accumulator, currentValue) => accumulator + currentValue;
    const myForm = document.getElementById("myForm");
    const csvFile = document.getElementById("csvFile");
    let globalObjArr = []
    let fxArr =[]
    let proArr =[]
    let rlArr = []
    let amArr = []
    let dsArr = []
    let hiArr =[]
    let siArr =[]
    let ssArr =[]
    let sfArr =[]
    let infoArea = document.getElementById('file-name-upload');
    csvFile.addEventListener( 'change', showFileName );
    function showFileName( event ) {
      let input = event.srcElement;
      let fileName = input.files[0].name;
      infoArea.textContent = fileName;
    }
    function checkPO (arr){
      let otherArr = []
      let DsCount = 0
      for (let i = 0; i < arr.length; i++) {
        if(String(arr[i].po).toUpperCase().includes("DS")){
          dsArr.push(arr[i])

        }
        else{
          otherArr.push(arr[i])
        }
      }
      for (let i = 0; i < dsArr.length; i++){
        skuSplit(dsArr[i],"DSTable",DsCount)
        DsCount++
      }
      return otherArr
    }
    function checkLocal(arr){
      let otherArr = []
      let localArr  = []
      let LocalCount = 0
      for (let i = 0; i < arr.length; i++) {
        if(arr[i].Local === "Local" || arr[i].Sku.includes("FME-") ){
          localArr.push(arr[i])

        }
        else{
          otherArr.push(arr[i])
        }
      }
      for (let i = 0; i < localArr.length; i++){
        insert_RowObj("LocalTable",localArr[i],LocalCount)
        LocalCount++
      }
      return otherArr
    }
    function checkAgent(arr){
      let otherArr = []
      let RlCount = 0
      let AMCount = 0
      let ProCount = 0
      let FxCount = 0
      for (let i = 0; i < arr.length; i++) {
        if(arr[i].ShipAgent === "AM_Home"){
          amArr.push(arr[i])
          skuSplit(arr[i],"AMTable",AMCount)
          AMCount++
        }
        else if(arr[i].ShipAgent === "Progistics"){
          proArr.push(arr[i])
          skuSplit(arr[i],"ProTable",ProCount)
          ProCount++
        }
        else if(arr[i].ShipAgent === "R&L"){
          rlArr.push(arr[i])
          skuSplit(arr[i],"RLTable",RlCount)
          RlCount++
        }
        else if(arr[i].ShipAgent === "FedEx"){
          fxArr.push(arr[i])
          skuSplit(arr[i],"FXTable",FxCount)
          FxCount++
        }
        else{
          otherArr.push(arr[i])
        }
      }
      return otherArr
    }
    function checkSku(arr){
      let otherArr = []
      let HiCount = 0
      let ProCount = 0
      for (let i = 0; i < arr.length; i++) {
        if(String(arr[i].Sku).includes("Haul") || String(arr[i].Sku).includes("Install")){
          hiArr.push(arr[i])
        }
        else{
          otherArr.push(arr[i])
        }
      }
      for (let i = 0; i < hiArr.length; i++){
        skuSplit(hiArr[i],"HITable",HiCount)
        HiCount++
      }
      return otherArr
    }
    function checkShipInfo(arr){
      let otherArr = []
      let SiCount = 0
      let SsCount = 0
      let RlProCount = 0
      let ProCount = document.getElementById("ProTable").rows.length;
      let FxCount = document.getElementById("FXTable").rows.length;
      for (let i = 0; i < arr.length; i++) {
        if(arr[i].ShipInfo.toUpperCase() === "INSIDE"){
          if(arr[i].AmHomeZip === "Outside Area"){
            skuSplit(arr[i],"ProTable",ProCount)
            ProCount++
          }
          else{
            skuSplit(arr[i],"SITable",SiCount)
            SiCount++
          }
        }
        else if(arr[i].ShipInfo.toUpperCase() === "STANDARD"){
          if(arr[i].totalWeight < 100 && arr[i].totalCube < 10 && arr[i].Subcategory[0] != "REFRIGERATOR" && arr[i].Subcategory[0] != "DISHWASHER" && arr[i].MaxShipping < 100){
            skuSplit(arr[i],"FXTable",FxCount)
            FxCount++
          }
          else{
            if(arr[i].AmHomeZip === "Outside Area"){
              skuSplit(arr[i],"RL/ProTable",RlProCount)
              RlProCount++
            }
            else{
              ssArr.push(arr[i])
              skuSplit(arr[i],"SSTable",SsCount)
              SsCount++
            }
          } 
        }
        else if(arr[i].ShipInfo.toUpperCase() === "FREE"){
          if(arr[i].Weight <= 50 ){
            skuSplit(arr[i],"FXTable",FxCount)
            FxCount++
          }
          else{
            sfArr.push(arr[i])
          }
        }
        else{
          otherArr.push(arr[i])
        }
      }
      return otherArr
    }
    function getZip(str){
        let str1 = String(str)
        let addressArr = str1.split(",")
        let zip = addressArr.pop()
        return zip
      }
    function skuSplit(obj,tableid,row){
      let product = obj.Product
      for (let i = 0; i< product.length; i++) {
        let productHead = ["AdW", "SKU", "Wt", "Category","Qty", "Class"]
        if( i === 0){
          insert_Row_Test(tableid,obj,row)
          skuInsertCell(tableid,row,product[i])
        }
        else{
          skuInsertCell(tableid,row,product[i])
        }
      }
    }
    function getAddress(str){
        let str1 = String(str)
        let addressArr = str1.split(",")
        let zip = addressArr.shift()
        return zip
    }
    function getDownloadString(arr){
      let downloadArr = ["Order, Zip, Weight, Cube, Margin, Price, Lareg Furniture, Bedding, Standard Furniture, Small Furniiture, Standard Apps, Pro 30, Pro 42, Pro 60, Accesories, Ship Info, Name, Address, Phone, City"]
      for( let i= 0; i < arr.length;i++){
        let obj = arr[i]
        downloadArr.push(`${obj.orderNo},${obj.Zip},${obj.totalWeight},${obj.totalCube},  ${obj.totalMargin}, ${obj.totalPrice}, ${obj.LargeFurn}, ${obj.Bedding}, ${obj.StandFurn}, ${obj.smallFurn}, ${obj.standardApp}, ${obj.ShipInfo},${obj.Customer},${obj.Address},${obj.phone},${obj.City},${obj.Subcategory[0]}`)
      }
      let downloadString = downloadArr.join('\n')
      return downloadString
    }

    
    function insert_RowObj(tableid,obj, row){
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);
      let h = x.insertCell(7);
      let i = x.insertCell(8);
      let j = x.insertCell(9);
      let k = x.insertCell(10);
      let l = x.insertCell(11);
      let m = x.insertCell(12);
      let n = x.insertCell(13);
      let col = 1
  
      a.innerHTML= `
        <div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.orderNo}',${row},${col},'${tableid}')">${obj.orderNo}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.orderNo}</span>
            </label>
        </div>`;
        col++
      b.innerHTML=`
        <div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Customer}',${row},${col},'${tableid}')">${obj.Customer}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Customer}</span>
            </label>
        </div>`;
        col++
      c.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.phone}',${row},${col},'${tableid}')">${obj.phone}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.phone}</span>
            </label>
        </div>`;
        col++
      d.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Address}',${row},${col},'${tableid}')">${obj.Address}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Address}</span>
            </label>
        </div>`;
        col++
      e.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Zip}',${row},${col},'${tableid}')">${obj.Zip}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Zip}</span>
            </label>
        </div>`;
        col++
      f.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.City}',${row},${col},'${tableid}')">${obj.City}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.City}</span>
            </label>
        </div>`;
        col++
      g.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.AmHomeZip}',${row},${col},'${tableid}')">${obj.AmHomeZip}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.AmHomeZip}</span>
            </label>
        </div>`;
        col++
      h.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.State}',${row},${col},'${tableid}')">${obj.State}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.State}</span>
            </label>
        </div>`;
        col++
      i.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Sku}',${row},${col},'${tableid}')">${obj.Sku}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Sku}</span>
            </label>
        </div>`;
        col++
      j.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalWeight}',${row},${col},'${tableid}')">${obj.totalWeight}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalWeight}</span>
            </label>
        </div>`;
        col++
      k.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalMargin}',${row},${col},'${tableid}')">${obj.totalMargin}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalMargin}</span>
            </label>
        </div>`;
        col++
      l.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.AppCar}',${row},${col},'${tableid}')">${obj.AppCar}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.AppCar}</span>
            </label>
        </div>`;
        col++
      m.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.MaxShipping}',${row},${col},'${tableid}')">${obj.MaxShipping}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.MaxShipping}</span>
            </label>
        </div>`;
        col++
      n.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <a href="https://admin.goedekers.com/admin/sales/order/view/order_id/${obj.EntityID}/key/${obj.MagentoKey}">Magento</a>
            </label>
        </div>`;
        

    }
    function insert_RowProfit(tableid,obj, row, costs){
      let totalProf = Number(obj.totalMargin - costs).toFixed(2)
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);
      let col = 1
      a.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.orderNo}',${row},${col},'${tableid}')">${obj.orderNo}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.orderNo}</span>
            </label>
        </div>`;
        col++
      b.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Sku}',${row},${col},'${tableid}')">${obj.Sku}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Sku}</span>
            </label>
        </div>`;
        col++
      c.innerHTML=`<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalMargin}',${row},${col},'${tableid}')">${obj.totalMargin}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalMargin}</span>
            </label>
        </div>`
        col++
      d.innerHTML=
        `<div id = "copy">
          <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${costs}</span>
        </div>`;
        col++
      e.innerHTML=`<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.ProfitGoal}',${row},${col},'${tableid}')">${obj.ProfitGoal}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.ProfitGoal}</span>
            </label>
        </div>`;
        col++
      f.innerHTML=
        `<div id = "copy">
          
          <span id="${tableid}Row${row}Col${col}">${totalProf}</span>
        </div>`;
        col++  
      g.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <a id="${tableid}Row${row}Col${col}" href="https://admin.goedekers.com/admin/sales/order/view/order_id/${obj.EntityID}/key/${obj.MagentoKey}">Magento</a>
            </label>
        </div>`
        col++  
    }
    function insert_Row_Test(tableid,obj,row){
      let State
      if (tableid === "ProTable"){
        State = obj.ProZip
      }
      else if (tableid === "AMTable"){
        State = obj.AmHomeZip
      }
      else{
        State = obj.State
      }
      let x=document.getElementById(tableid).insertRow(-1);
      x.id = `${tableid}row${row}`
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);
      let g = x.insertCell(6);
      let h = x.insertCell(7);
      let i = x.insertCell(8);
      let j = x.insertCell(9);
      let k = x.insertCell(10);
      let l = x.insertCell(11);
      let m = x.insertCell(12);
      let n = x.insertCell(13);
      let col = 1

      a.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.orderNo}',${row},${col},'${tableid}')">${obj.orderNo}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.orderNo}</span>
            </label>
        </div>`;
        col++
      b.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Customer}',${row},${col},'${tableid}')">${obj.Customer}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Customer}</span>
            </label>
        </div>`;
        col++
      c.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Address}',${row},${col},'${tableid}')">${obj.Address}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Address}</span>
            </label>
        </div>`;
        col++
      d.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.Zip}',${row},${col},'${tableid}')">${obj.Zip}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.Zip}</span>
            </label>
        </div>`;
        col++
      e.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.phone}',${row},${col},'${tableid}')">${obj.phone}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.phone}</span>
            </label>
        </div>`;
        col++
      f.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.City}',${row},${col},'${tableid}')">${obj.City}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.City}</span>
            </label>
        </div>`;
        col++
      g.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${State}',${row},${col},'${tableid}')">${State}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${State}</span>
            </label>
        </div>`;
        col++
      h.innerHTML=`
        <table id = "${tableid}ProductRow${row}Col${col}" class="skuTable"> 
          <th class = "col1">AdW</th>
          <th class = "col2">SKU</th>
          <th class = "col3">Wt</th>
          <th class = "col4">Category</th>
          <th class = "col5">Qty</th>
          <th class = "col6">Class</th>
        </table>`;
        col++
      i.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalWeight}',${row},${col},'${tableid}')">${obj.totalWeight}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalWeight}</span>
            </label>
        </div>`;
        col++
      j.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.totalCube}',${row},${col},'${tableid}')">${obj.totalCube}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.totalCube}</span>
            </label>
        </div>`;
        col++
      k.innerHTML=
      `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.PONum[0]}',${row},${col},'${tableid}')">${obj.PONum}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">PO#</span>
            </label>
        </div>`;
        col++
      l.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${obj.MaxShipping}',${row},${col},'${tableid}')">${obj.MaxShipping}</button>
              <span id="${tableid}Row${row}Col${col}" class="btn btn-primary">${obj.MaxShipping}</span>
            </label>
        </div>`;
        col++
      m.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <a id="${tableid}Row${row}Col${col}" href="https://admin.goedekers.com/admin/sales/order/view/order_id/${obj.EntityID}/key/${obj.MagentoKey}">Magento</a>
            </label>
        </div>`
        col++
      n.innerHTML=
        `<div class="dropdown">
          <button onclick="myFunction('${tableid}',${row})" class="dropbtn">Send</button>
          <div id="Dropdown${tableid}${row}" class="dropdown-content">
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToRL('${tableid}',${row},globalObjArr)">RL</button>
                <span class="btn btn-primary">R&L</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToPro('${tableid}',${row},globalObjArr)">Progistics</button>
                <span class="btn btn-primary">Progistics</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToAM('${tableid}',${row},globalObjArr)">AM Home</button>
                <span class="btn btn-primary">AM Home</span>
              </label>
            </div>
            <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToFX('${tableid}',${row},globalObjArr)">FEDEX</button>
                <span class="btn btn-primary">FEDEX</span>
              </label>
            </div>
              <div class = "Drop">
              <label class="DropLabel">
                <button onclick="sendToProfit('${tableid}',${row},globalObjArr)">Profit</button>
                <span class="btn btn-primary">Profit</span>
              </label>
            </div>
            </div>
          </div>
        </div>`;

    }
    function skuInsertCell(tableid,row,arr){
      let x=document.getElementById(`${tableid}ProductRow${row}Col8`).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      let c = x.insertCell(2);
      let d = x.insertCell(3);
      let e = x.insertCell(4);
      let f = x.insertCell(5);

      a.innerHTML=`${arr[10]}`;
      b.innerHTML=
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboardBase('${arr[13]}')">${arr[1]}</button>
              <span class="btn btn-primary">${arr[1]}</span>
            </label>
        </div>`
      c.innerHTML=`${arr[2]}`;
      d.innerHTML=`${arr[9]}`;
      e.innerHTML=`${arr[11]}`;
      f.innerHTML=`${arr[14]}`;


    }
    function insert_Row2(tableid,text1,text2){
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      a.innerHTML=`${text1}`;
      b.innerHTML=`${text2}`;
    }
    function insert_Row_Button(tableid,text1,text2,iterator){
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      a.innerHTML= 
        `<div id = "copy">
            <label class="copylabel">
              <button onclick="copyToClipboard('${text1}',${iterator},1)">${text1}</button>
              <span id="copy1${iterator}" class="btn btn-primary">${text1}</span>
            </label>
        </div>`
      b.innerHTML=
        `<div id="copy">
          <label class="copylabel">
            <button onclick="copyToClipboard('${text2}',${iterator},2)">${text2}</button>
            <span id="copy2${iterator}" class="btn btn-primary">${text2}</span>
          </label>
        </div>`
    }
    function openMagento(entityid){
      let magentoKey = ["b9cc24e34287219037475d8441e9fc64626e721592bc553bfb9006da85fdc253"]
      window.open(`https://admin.goedekers.com/admin/sales/order/view/order_id/${entityid}/key/${magentoKey[0]}/`)
    }
    
    function shippingProfitCost(tableid,row,col,obj){
      let input = Number(document.getElementById(`${tableid}Row${row}Col${col}`).value)
      console.log(input)
      let profit = Number(obj - input)
      console.log(profit)
      let newCol = col + 2
      let ogOutput = document.getElementById(`${tableid}Row${row}Col${newCol}`)
      let parentDiv = ogOutput.parentNode
      let newspan = document.createElement("span");
      let newnode = document.createTextNode(`${profit}`);
      newspan.appendChild(newnode)
      newspan.setAttribute('id',`${tableid}Row${row}Col${newCol}`);
      newspan.setAttribute('class',"btn btn-primary");

      
      parentDiv.replaceChild(newspan,ogOutput)
    }
    function insert_Row3(tableid,text1,text2){
      let x=document.getElementById(tableid).insertRow(-1);
      let a = x.insertCell(0);
      let b = x.insertCell(1);
      a.innerHTML=`${text1}`;
      b.innerHTML=`${text2}`;
    }
    function myFunction(tableid,row) {
      let id = `Dropdown${tableid}${row}`
      console.log(id) 
      document.getElementById(`Dropdown${tableid}${row}`).classList.toggle("show");
    }      

// Close the dropdown menu if the user clicks outside of it
  window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
function sendToRL(tableid,row,arr){
  let id =`${tableid}Row${row}Col1`
  console.log(id)
  let order = document.getElementById(`${tableid}Row${row}Col1`)
  let tableRow = document.getElementById(`${tableid}row${row}`)
  let rowIndex = tableRow.rowIndex
  let orderNum = order.innerText
  let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
  console.log(objIndex)
  let obj = arr[objIndex]
  console.log(obj)
  let rowCount = document.getElementById("RLTable").rows.length;
  
  if(rowCount === 0){
    let rowStart = rowCount
  }
  else{
    let rowStart = rowCount+1
  }
  let rowStart = rowCount+1
  skuSplit(obj,"RLTable",rowStart)
  document.getElementById(tableid).deleteRow(rowIndex);


  

}
function sendToAM(tableid,row,arr){
  let newTable ="AMTable"
  let order = document.getElementById(`${tableid}Row${row}Col1`)
  let tableRow = document.getElementById(`${tableid}row${row}`)
  let rowIndex = tableRow.rowIndex
  let orderNum = order.innerText
  let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
  let obj = arr[objIndex]
  let rowCount = document.getElementById(newTable).rows.length;
  let rowStart = rowCount+1
  skuSplit(obj,newTable,rowStart)
  document.getElementById(tableid).deleteRow(rowIndex);

  
}
function sendToProfit(tableid,row,arr){
  let newTable ="ProfitTable"
  let costs = prompt("Enter Shipping Cost");
  let order = document.getElementById(`${tableid}Row${row}Col1`)
  let tableRow = document.getElementById(`${tableid}row${row}`)
  let rowIndex = tableRow.rowIndex
  let orderNum = order.innerText
  let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
  let rowCount = document.getElementById(newTable).rows.length;
  let rowStart = rowCount+1
  insert_RowProfit(newTable,arr[objIndex], rowStart, costs)
  document.getElementById(tableid).deleteRow(rowIndex);

}
function sendToPro(tableid,row,arr){
  let newTable ="ProTable"
  let order = document.getElementById(`${tableid}Row${row}Col1`)
  let tableRow = document.getElementById(`${tableid}row${row}`)
  let rowIndex = tableRow.rowIndex
  let orderNum = order.innerText
  let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
  let obj = arr[objIndex]
  let rowCount = document.getElementById(newTable).rows.length;
  let rowStart = rowCount+1
  skuSplit(obj,newTable,rowStart)
  document.getElementById(tableid).deleteRow(rowIndex);

}
function sendToFX(tableid,row,arr){
  let newTable ="FXTable"
  let order = document.getElementById(`${tableid}Row${row}Col1`)
  let tableRow = document.getElementById(`${tableid}row${row}`)
  let rowIndex = tableRow.rowIndex
  let orderNum = order.innerText
  let objIndex = arr.findIndex(Line => Line.orderNo === orderNum)
  let obj = arr[objIndex]
  let rowCount = document.getElementById(newTable).rows.length;
  let rowStart = rowCount+1
  skuSplit(obj,newTable,rowStart)
  document.getElementById(tableid).deleteRow(rowIndex);
}
    function copyToClipboard(text,iterator,column,tableid) {
      let input = document.createElement('input');
      input.setAttribute('value', text);
      document.body.appendChild(input);
      input.select();
      let result = document.execCommand('copy');
      let span = document.getElementById(`${tableid}Row${iterator}Col${column}`)
      console.log(span)
      span.style.setProperty("text-decoration", "line-through")
      copycounter =
      document.body.removeChild(input);
      return result;
    }
    function copyToClipboardBase(text) {
      let input = document.createElement('input');
      input.setAttribute('value', text);
      document.body.appendChild(input);
      input.select();
      let result = document.execCommand('copy');
      document.body.removeChild(input);
      return result;
    }
    function copyFedexToClipboard(text,iterator) {
      let input = document.createElement('input');
      input.setAttribute('value', text);
      document.body.appendChild(input);
      input.select();
      let result = document.execCommand('copy');
      let span = document.getElementById(`copy${iterator}Fedex`)
      console.log(span)
      span.style.setProperty("text-decoration", "line-through")
      document.body.removeChild(input);
      return result;
    }
    function openCity(evt, cityName) {
      let i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(cityName).style.display = "block";
      evt.currentTarget.className += " active";
    }
    function strToArr( strData, strDelimiter ){
        strDelimiter = (strDelimiter || ",");
        let objPattern = new RegExp(
            (
                "(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +
                "(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +
                "([^\"\\" + strDelimiter + "\\r\\n]*))"
            ),
            "gi"
            );
        let arrData = [[]];
        let arrMatches = null;
        while (arrMatches = objPattern.exec( strData )){
            let strMatchedDelimiter = arrMatches[ 1 ];
            if (strMatchedDelimiter.length && strMatchedDelimiter !== strDelimiter){
                arrData.push( [] );
            }
            let strMatchedValue;
            if (arrMatches[ 2 ]){
                strMatchedValue = arrMatches[ 2 ].replace(
                    new RegExp( "\"\"", "g" ),
                    "\""
                    );
            } 
            else {
                strMatchedValue = arrMatches[ 3 ];
            }
            arrData[ arrData.length - 1 ].push( strMatchedValue );
        }
        return( arrData );
    }
    function csvToArray(str, delimiter = ",") {
      let rowArr = strToArr(str)
      let objArr = getObjArray(rowArr)
      let finalObjArr = getProductArr(objArr)
      console.log(finalObjArr)
      let afterpo = checkPO(finalObjArr)
      let afterLocal = checkLocal(afterpo)
      let afterSku = checkSku(afterLocal)
      let afterAgent = checkAgent(afterSku)
      let afterShipInfo = checkShipInfo(afterAgent)
      let downloadString = getDownloadString(ssArr)
      download(downloadString, `ready to ship.csv`,csvFile)
      // console.log(amArr)
      // console.log(fxArr)
      // console.log(proArr)
      // console.log(rlArr)
      // console.log(dsArr)
    }
    function download(data, filename, type) {
      let file = new Blob([data], {type: type});
      if (window.navigator.msSaveOrOpenBlob) // IE10+
          window.navigator.msSaveOrOpenBlob(file, filename);
      else { // Others
          var a = document.createElement("a"),
                  url = URL.createObjectURL(file);
          a.href = url;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          setTimeout(function() {
              document.body.removeChild(a);
              window.URL.revokeObjectURL(url);  
          }, 0); 
      }
    }
    function getskuArr(arr1,arr2){
      skuArr = []
      if(arr1[0] === arr2[0]){
        skuArr.push(arr1[10])
      }



      return skuArr
    }
    function getRLClass(obj){
        let rlClassArr = []
        for(let i = 0; i < obj.Sku.length; i++){
          if(RlClassMapper(obj.Subcategory[i]) === "Density"){
            let height = (obj.Height[i] + 6)/12
            let width = 40/12
            let length = 48/12
            let weight = obj.Weight[i] + 40
            let volume = (length * width * height)
            let density = weight/volume
            if (density >= 30){
              rlClassArr.push(60)
            }
            else if (density >= 22.5 && density < 30){
              rlClassArr.push(65)
            }
            else if (density >= 15 && density < 22.5){
              rlClassArr.push(70)
            }
            else if (density >= 12 && density < 15){
              rlClassArr.push(85)
            }
            else if (density >= 10 && density < 12){
              rlClassArr.push(92.5)
            }
            else if (density >= 8 && density < 10){
              rlClassArr.push(100)
            }
            else if (density >= 6 && density < 8){
              rlClassArr.push(125)
            }
            else if (density >= 4 && density < 6){
              rlClassArr.push(175)
            }
            else if (density >= 2 && density < 4){
              rlClassArr.push(250)
            }
            else if (density >= 1 && density < 2){
              rlClassArr.push(300)
            }
            else if (density < 1){
              rlClassArr.push(400)
            }
          }
          else{
            rlClassArr.push(RlClassMapper(obj.Subcategory[i]))
          }
        }
        return rlClassArr
      }
    function getProductArr(arr){
      let finalObjArr = []
      for (let i = 0; i < arr.length; i++){
        let productArr = []
        let obj = arr[i]
        let order = obj.orderNo
        let name = obj.Customer
        let address = obj.Address
        let phone = obj.phone
        let zip = obj.Zip
        let poNotes = obj.po.split(";")
        let sku = obj.Sku
        let weight = obj.Weight
        let margin = obj.Margin
        let city = obj.City
        let state = obj.State
        let shipAgent = obj.ShipAgent
        let shipInfo = obj.ShipInfo
        let cat = obj.Category
        let subCat = obj.Subcategory
        let height = obj.Height
        let width = obj.Width
        let depth = obj.Depth
        let cube = obj.Cube
        let price = obj.Price
        let adWidth = obj.AdWidth
        let qty = obj.Quantity
        let poNum = obj.PONum
        let entityid = obj.EntityID
        let paidShip = obj.ShipPaid
        let rlClass = getRLClass(obj)
        for (let i = 0; i < sku.length; i++) {
          if(poNotes[i] === undefined){
            poNotes.push("")
          }       
          if (sku[i].toUpperCase().includes("WARRANTY") || sku[i].toUpperCase().includes("INSTALL-") || sku[i].toUpperCase().includes("HAULAWY") || poNotes[i].toUpperCase().includes("DS")){
            continue
          }
            let rlSku = String(sku[i]+"-"+subCat[i])

            let line = [poNotes[i],sku[i],weight[i],margin[i],height[i],width[i],depth[i],price[i],cat[i],subCat[i],adWidth[i],qty[i],poNum[i],rlSku,rlClass[i]]
            productArr.push(line)
            // let newProd = new Product(poNotes[i],sku[i],weight[i],margin[i],height[i],width[i],depth[i],price[i],cat[i],subCat[i],adWidth[i],qty[i],poNum[i],rlSku,rlClass[i])
            // productArr.push(newProd)
          }
        
        let orderObj = new Line(order,name,address,phone,poNotes,sku,weight,zip,state,shipAgent,shipInfo,city,margin,productArr,cat,subCat,height,width,depth,cube,price,adWidth,qty,poNum,entityid,paidShip)
        finalObjArr.push(orderObj)
        globalObjArr.push(orderObj)
      }
      return finalObjArr
    }
    function getObjArray(arr){
        let objArr = []
        let skuArr = []
        let wtArr = []
        let marginArr = []
        let htArr= []
        let wideArr = []
        let depthArr = []
        let cubeArr = []
        let priceArr=[]
        let catArr = []
        let subCatArr = []
        let adWideArr = []
        let qtyArr =[]
        let poArr = []
        let poNumArr = []
        for(let i = 1; i < arr.length; i++){
            let l = i - 1 
            let interExport = arr[i]
            let previous = arr[l] 
            if(i === 1){
              continue
            }
            else if (arr[i][0] === arr[l][0]){
              let initCost 
              if (Number(previous[13]) > Number(previous[25]) && Number(previous[25]) > 0){
                initCost = Number(previous[25])
              }
              else{
                initCost = (Number(previous[13]))}
              let margin = Math.ceil(Number(Number(previous[14]) - initCost))
              priceArr.push(Number(previous[14]))
              skuArr.push(previous[10])
              wtArr.push(Math.ceil(Number(previous[11])))
              marginArr.push(margin)
              catArr.push(previous[19])
              qtyArr.push(Number(previous[23]))
              let preSubCat = previous[20].split(" ")
              let midSubCat
              if(preSubCat[0] === "Wall" || preSubCat[0] === "Ice" || preSubCat[0] === "Trash"){
                midSubCat = String(`${preSubCat[0]} ${preSubCat[1]}`).replace(/['"]+/g, '')
              }
              else{
                midSubCat = String(preSubCat[0]).replace(/['"]+/g, '')
              }
              if(String(midSubCat).slice(-1).toLowerCase() === "s"){
                let text = String(midSubCat).toUpperCase()
                let editedText = text.slice(0, -1)
                subCatArr.push(editedText)
              }
              else{
                subCatArr.push(midSubCat.toUpperCase())
              }
              if (previous[22] === undefined){
                poNumArr.push("")
              }
              else{
                poNumArr.push(previous[22])
              }
              
              if (previous[21] === undefined){
                adWideArr.push(0)
              }
              else{
                adWideArr.push(previous[21])
              }
              if(previous[16] === undefined){
                htArr.push(0)
                wideArr.push(0)
                depthArr.push(0)
              }
              else{
                htArr.push(Number(previous[16]))
                wideArr.push(Number(previous[17]))
                depthArr.push(Number(previous[18]))
              }
              cubeArr.push(Math.ceil(Number(previous[16])/12 * Number(previous[17])/12 * Number(previous[18])/12))
            }
            else{
              let initCost 
              if (Number(previous[13]) > Number(previous[25]) && Number(previous[25]) > 0){
                initCost = Number(previous[25])
              }
              else{
                initCost = (Number(previous[13]))}
              let margin = Math.ceil(Number(Number(previous[14]) - initCost))
              qtyArr.push(Number(previous[23]))
              let preSubCat = previous[20].split(" ")
              let midSubCat
              if(preSubCat[0] === "Wall" || preSubCat[0] === "Ice" || preSubCat[0] === "Trash"){
                midSubCat = String(`${preSubCat[0]} ${preSubCat[1]}`).replace(/['"]+/g, '')
              }
              else{
                midSubCat = String(preSubCat[0]).replace(/['"]+/g, '')
              }
              if(String(midSubCat).slice(-1).toLowerCase() === "s"){
                let text = String(midSubCat).toUpperCase()
                let editedText = text.slice(0, -1)
                subCatArr.push(editedText)
              }
              else{
                subCatArr.push(midSubCat.toUpperCase())
              }
              if (previous[22] === undefined){
                poNumArr.push("")
              }
              else{
                poNumArr.push(previous[22])
              }
              if (previous[21] === undefined){
                adWideArr.push(0)
              }
              else{
                adWideArr.push(previous[21])
              }
              if(previous[16] === undefined){
                htArr.push(0)
                wideArr.push(0)
                depthArr.push(0)
              }
              else{
                htArr.push(Number(previous[16]))
                wideArr.push(Number(previous[17]))
                depthArr.push(Number(previous[18]))
              }
              catArr.push(String(previous[19]).replace(/['"]+/g, ''))
              subCatArr.push(String(previous[20]).replace(/['"]+/g, ''))
              priceArr.push(Number(previous[14]))
              cubeArr.push(Math.ceil(Number(previous[16])/12 * Number(previous[17])/12 * Number(previous[18])/12))
              skuArr.push(previous[10])
              wtArr.push(Math.ceil(Number(previous[11])))
              marginArr.push(margin)
              let order = previous[0]
              let name = String(`${previous[1]} ${previous[2]}`)
              let address = String(`${previous[4]} ${previous[5]}`)
              let phone = previous[3]
              let rawZip = previous[7].split("-")
              let zip = rawZip[0]
              let sku = skuArr
              let state = previous[8]
              let poNotes = String(previous[9]).replace(/['"]+/g, '')
              let weight = wtArr
              let product = ""
              let preShip = String(previous[12])
              let shipInfo
              if (preShip.toUpperCase().includes("INSIDE")) {
                shipInfo = "Inside"
              }
              else if (preShip.toUpperCase().includes("LOCAL") || preShip.toUpperCase().includes("TERRY") ) {
                shipInfo = "Local"
              }
              else if (preShip.toUpperCase().includes("PICK UP")) {
                shipInfo = "Pick Up"
              }
              else if (preShip.toUpperCase().includes("STANDARD DELIVERY")) {
                shipInfo = "Standard"
              }
              else if (preShip.toUpperCase().includes("FREE")) {
                shipInfo = "Free"
              }
              else{
                shipInfo = "Unknown"
              }
              let shipAgent = previous[15]
              let entityid = Number(previous[24])
              let height = htArr
              let price = priceArr
              let width = wideArr
              let depth = depthArr
              let cube = cubeArr
              let cat = catArr
              let adWidth = adWideArr
              let subCat = subCatArr
              let city = previous[6]
              let paidShip = Number(previous[26])
              console.log(paidShip)
              let orderObj = new Line(order,name,address,phone,poNotes,sku,weight,zip,state,shipAgent,shipInfo,city,marginArr,product,cat,subCat,height,width,depth,cube,price,adWidth,qtyArr,poNumArr,entityid,paidShip)
              objArr.push(orderObj)
              skuArr = []
              wtArr = []
              marginArr = []
              htArr = []
              wideArr = []
              depthArr = []
              cubeArr = []
              priceArr = []
              catArr=[]
              subCatArr=[]
              adWideArr = []
              qtyArr =[]
              poNumArr = []
            }



            // console.log(orderObj)
            // console.log(orderObj.orderNo)
            
        }
        return objArr
    }
    class Product{
      constructor(PONotes,Sku,Weight,Margin,Height,Width,Depth,Price,Category,SubCategory,AdWidth,Quantity,PONum,RLSku,Class){
        this.PONotes = PONotes
        this.Sku = Sku
        this.Weight = Weight
        this.Margin = Margin
        this.Height = Height
        this.Width = Width
        this.Depth  = Depth
        this.Price = Price
        this.Category = Category
        this.SubCategory = Subategory
        this.AdWidth = AdWidth
        this.Quantity = Quantity
        this.PONum = PONum
        this.RLSku = RLSku
        this.Class = Class
      }

    }
    class Line{
      constructor(orderNo,Customer,Address,phone,po,Sku,Weight,Zip,State,ShipAgent,ShipInfo,City,Margin, Product,Category,Subcategory,Height,Width,Depth,Cube,Price,AdWidth,Quantity,PONum,EntityID,ShipPaid){
        this.orderNo = String(orderNo).replace(/['"]+/g, '')
        this.po = po
        this.Customer = String(Customer).replace(/['"]+/g, '')
        this.Sku = Sku
        this.Address = String(Address).replace(/['"]+/g, '')
        this.Weight = Weight
        this.phone = String(phone).replace(/['"]+/g, '')
        this.Zip = Number(Zip)
        this.AmHomeZip = amHomeMapper(Number(Zip))
        this.ProZip = ProMapper(Number(Zip))
        this.State = String(State).replace(/['"]+/g, '')
        this.ShipAgent = String(ShipAgent).replace(/['"]+/g, '')
        this.ShipInfo = String(ShipInfo).replace(/['"]+/g, '')
        this.City = String(City).replace(/['"]+/g, '')
        this.Product = Product
        this.Margin = Margin
        this.Local = localZipMapper(Number(Zip))
        this.Price = Price
        this.AdWidth = AdWidth
        this.Category = Category
        this.Subcategory = Subcategory
        this.Height = Height
        this.Depth = Depth
        this.Width = Width
        this.Cube = Cube
        this.Quantity = Quantity
        this.PONum = PONum
        this.EntityID = EntityID
        this.MagentoKey = "b9cc24e34287219037475d8441e9fc64626e721592bc553bfb9006da85fdc253"
        this.ShipPaid = ShipPaid
      }
      get totalWeight(){
        return this.getProductWeight(this.Product)
      }
      get totalPrice(){
        return this.getTotal(this.Price)
      }
      get totalMargin(){
        return this.getTotal(this.Margin)
      }
      get totalCube(){
        return this.getTotal(this.Cube)
      }
      get standardApp(){
        return this.getStandardApp(this.Product)
      }
      get accessories(){
        return this.getAccessories(this.Product)
      }
      get pro30App(){
        return this.getOtherApp(this.Product,30,36)
      }
      get pro42App(){
        return this.getOtherApp(this.Product,42,48)
      }
      get smallFurn(){
        return this.getSmallFurn(this.Product)
      }
      get Bedding(){
        return this.getBedding(this.Product)
      }
      get LargeFurn(){
        return this.getLargeFurn(this.Product)
      }
      get StandFurn(){
        return this.getStandFurn(this.Product)
      }
      get prodWeight(){
        return this.getProductWeight(this.Product)
      }
      get ClassArr(){
        return this.getRLClass(this.Sku,this.Weight,this.Height)
      }
      get ProfitGoal(){
        return this.getProfitGoal(this.totalPrice)

      }
      get MaxShipping(){
        return this.getMaxShipping(this.totalPrice,this.totalMargin,this.ShipPaid)
      }
      getMaxShipping(Price, Margin, ShipPaid){
        let requiredProfit = Price * 0.1
        let newMargin = Number(Margin + ShipPaid)
        let maxship = Number(newMargin - requiredProfit).toFixed(2)
        return maxship
      }
      getProfitGoal(Price){
        let requiredProfit = Number(Price * 0.1).toFixed(2)
        return requiredProfit
      }



      getRLClass(arr, Weight,Height){
        let rlClassArr = []
        for(let i = 0; i < arr.length; i++){
          let obj = arr[i]
          let height = (Height+ 6)/12
          let width = 40/12
          let length = 48/12
          let weight = Weight + 40
          let volume = (length * width * height)
          let density = weight/volume
          if (density >= 50){
            rlClassArr.push(50)
          }
          else if (density >= 35 && density < 50){
            rlClassArr.push(55)
          }
          else if (density >= 30 && density < 35){
            rlClassArr.push(60)
          }
          else if (density >= 22.5 && density < 30){
            rlClassArr.push(65)
          }
          else if (density >= 15 && density < 22.5){
            rlClassArr.push(70)
          }
          else if (density >= 13.5 && density < 15){
            rlClassArr.push(77.5)
          }
          else if (density >= 12 && density < 13.5){
            rlClassArr.push(85)
          }
          else if (density >= 10.5 && density < 12){
            rlClassArr.push(92.5)
          }
          else if (density >= 9 && density < 10.5){
            rlClassArr.push(100)
          }
          else if (density >= 9 && density < 10.5){
            rlClassArr.push(100)
          }
          else if (density >= 9 && density < 10.5){
            rlClassArr.push(100)
          }
          else if (density >= 8 && density < 9){
            rlClassArr.push(110)
          }
          else if (density >= 7 && density < 8){
            rlClassArr.push(125)
          }
          else if (density >= 6 && density < 7){
            rlClassArr.push(150)
          }
          else if (density >= 5 && density < 6){
            rlClassArr.push(175)
          }
          else if (density >= 4 && density < 5){
            rlClassArr.push(200)
          }
          else if (density >= 3 && density < 4){
            rlClassArr.push(250)
          }
          else if (density >= 2 && density < 3){
            rlClassArr.push(300)
          }
          else if (density >= 1 && density < 2){
            rlClassArr.push(400)
          }
          else if (density < 1){
            rlClassArr.push(500)
          }
        }
        return rlClassArr
      }
      getProductWeight(arr){
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + (arr[i][2] * arr[i][11])
        }
        return counter
      }    
      getTotal(arr) {
        let counter = 0
        for (let i = 0; i < arr.length; i++){
          counter = counter + arr[i]
        }
        return counter
      }
      getSmallFurn(arr){
        let counter = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          let subCat = obj[9].toLowerCase()
          let cat = obj[8].toLowerCase()
          if(obj[8].toUpperCase() === "FURNITURE"){
            if(cat.includes("bed")){
              continue
            }
            else{
              if(obj[4] > 80 || obj[5] > 80 || obj [6] > 80 || subCat.includes("sofa")){
                continue
              }
              else{
                if(obj[2] <= 40 ){
                  counter++
                }
                else{
                  continue
                }
              }
            }
          }
          else{
            continue
          }
        }
        return counter
      }
      getBedding(arr){
        let counter = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          let subCat = obj[9].toLowerCase()
          let cat = obj[8].toLowerCase()
          if(obj[8].toUpperCase() === "FURNITURE"){
            if(cat.includes("bed")){
              counter++
            }
            else{
              continue
            }
          }
        }
        return counter
      }
      getStandFurn(arr){
        let counter = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          let subCat = obj[9].toLowerCase()
          let cat = obj[8].toLowerCase()
          if(obj[8].toUpperCase() === "FURNITURE"){
            if(cat.includes("bed")){
              continue
            }
            else{
              if(obj[4] > 80 || obj[5] > 80 || obj [6] > 80 || subCat.includes("sofa")){
                continue
              }
              else{
                if(obj[2] > 40 ){
                  counter++
                }
                else{
                  continue
                }
              }
            }
          }
          else{
            continue
          }
        }
        return counter
      }
      getLargeFurn(arr){
        let counter = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          let subCat = obj[9].toLowerCase()
          let cat = obj[8].toLowerCase()
          if(obj[8].toUpperCase() === "FURNITURE"){
            if(cat.includes("bed")){
              continue
            }
            else{
              if(obj[4] > 80 || obj[5] > 80 || obj [6] > 80 || subCat.includes("sofa")){
                counter++
              }
              else{
                continue
              }
            }
          }
          else{
            continue
          }
        }
        return counter
      }
      getStandardApp(arr){
        let standardCounter = 0
        let pro30Counter = 0
        let pro42Counter = 0
        let pro60Counter = 0
        let accCounter = 0 
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          if(obj[8].toUpperCase() === "FURNITURE"){
            continue
          }
          else{
            if(obj[2] < 20 ){
              accCounter++            
            }
            else{
              if(obj[10] >= 30 && obj[10] <= 36){
                pro30Counter++
              }
              else if(obj[10] >= 42 && obj[10] <= 48){
                pro42Counter++
              }
              else if(obj[10] >= 60){
                pro60Counter++
              }
              else{
                standardCounter++
              }

            }
          }
        }
        let finalString = (`${standardCounter}, ${pro30Counter}, ${pro42Counter}, ${pro60Counter}, ${accCounter}`)
      return finalString
      }
      getOtherApp(arr,base,ceil){
        let counter = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          if(obj[8].toUpperCase() === "FURNITURE"){
            continue
          }
          else{
            if(obj[2] > 20 ){
              if(obj[4] >= base && obj[4] <= ceil){
                counter++
              }
              else if(obj[5] >= base && obj[5] <= ceil){
                counter++
              }
              else if(obj[6] >= base && obj[6] <= ceil){
                counter++
              }
              else{
                continue
              }
            }
            else{ 
              continue
            }
          }
        }
      return counter
      }
      getAccessories(arr){
        let counter = 0
        for( let i = 0;i< arr.length;i++){
          let obj = arr[i]
          if(obj[2] < 20 ){
            counter++
          }
          else{ 
            continue
          }
        }
      return counter
      }
    }
    myForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const input = csvFile.files[0];
      const reader = new FileReader();
      reader.onload = function (e) {
        const text = e.target.result;
        const data = csvToArray(text);
      };
      reader.readAsText(input);
    });
  </script>
</body>